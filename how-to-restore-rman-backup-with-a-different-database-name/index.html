<!DOCTYPE html><html lang="vi"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>How to Restore RMAN Backup with a Different Database Name - TRUNG DUONG</title><meta name="robots" content="noindex,nofollow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="alternate" type="application/atom+xml" href="https://ddtrungit.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://ddtrungit.github.io/feed.json"><link rel="stylesheet" href="https://ddtrungit.github.io/assets/css/style.css?v=6ddec22a33b6e591633ba53617c15038"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://ddtrungit.github.io/how-to-restore-rman-backup-with-a-different-database-name/index.html"},"headline":"How to Restore RMAN Backup with a Different Database Name","datePublished":"2021-01-22T08:30","dateModified":"2022-06-13T14:27","image":{"@type":"ImageObject","url":"https://ddtrungit.github.io/media/posts/60/What-is-RMAN-Oracle.jpg","height":500,"width":900},"description":"Hello friends, in this article I’m going to demonstrate to you Restore RMAN Backup with a Different Database Name on&hellip;","author":{"@type":"Person","name":"Duong Dinh Trung","url":"https://ddtrungit.github.io/authors/dtrungit/"},"publisher":{"@type":"Organization","name":"Duong Dinh Trung","logo":{"@type":"ImageObject","url":"https://ddtrungit.github.io/media/website/Background_2.png","height":800,"width":834}}}</script></head><body><header class="header" id="js-header"><a href="https://ddtrungit.github.io/index.html" class="logo"><img src="https://ddtrungit.github.io/media/website/Background_2.png" alt="TRUNG DUONG"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://ddtrungit.github.io/index.html" target="_self">Home</a></li><li><a href="https://ddtrungit.github.io/gioi-thieu/index.html" target="_self">About</a></li><li><a href="https://ddtrungit.github.io/tags/ansible/index.html" target="_self">Ansible</a></li><li><a href="https://ddtrungit.github.io/tags/aws/index.html" target="_self">AWS</a></li><li><a href="https://ddtrungit.github.io/tags/oracle/index.html" target="_self">Oracle</a></li><li><a href="https://ddtrungit.github.io/tags/linux/index.html" target="_self">Linux</a></li><li><a href="https://ddtrungit.github.io/tags/zimbra/index.html" target="_self">Zimbra</a></li><li><a href="https://ddtrungit.github.io/tags/tip/index.html" target="_self">TIP</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://ddtrungit.github.io/tags/oracle/index.html" class="post__maintag">Oracle</a><h1 class="post__title">How to Restore RMAN Backup with a Different Database Name</h1><div class="post__meta"><div class="post__author">By <a href="https://ddtrungit.github.io/authors/dtrungit/index.html" class="invert" rel="author" title="Duong Dinh Trung">Duong Dinh Trung</a></div></div></header><figure class="post__featured-image"><img src="https://ddtrungit.github.io/media/posts/60/What-is-RMAN-Oracle.jpg" srcset="https://ddtrungit.github.io/media/posts/60/responsive/What-is-RMAN-Oracle-xs.jpg 300w, https://ddtrungit.github.io/media/posts/60/responsive/What-is-RMAN-Oracle-sm.jpg 480w, https://ddtrungit.github.io/media/posts/60/responsive/What-is-RMAN-Oracle-md.jpg 768w, https://ddtrungit.github.io/media/posts/60/responsive/What-is-RMAN-Oracle-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="500" width="900" alt=""></figure><div class="post__inner"><div class="post__entry"><p></p><p>Hello friends, in this article I’m going to demonstrate to you Restore RMAN Backup with a Different Database Name on New Server step by step guide.</p><p></p><p></p><p></p><p></p><h2><strong>Steps</strong> to Clone database to different DB name use RMAN</h2><p></p><p></p><ol><li><strong>Full or Level 0 Database RMAN backup.</strong></li><li><strong>Controlfile backup.</strong></li><li><strong>spfile backup.</strong></li><li><strong>Password file backup.</strong></li></ol><p></p><p></p><figure class="wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-16-9 wp-has-aspect-ratio"><div class="wp-block-embed__wrapper">https://youtu.be/IcvAr0TPilA</div></figure><p></p><p></p><h3><strong>Taking</strong> <strong>Full or Level 0 Database RMAN backup</strong></h3><p></p><p></p><p>Before taking RMAN backup need to check datafile, aduit file and controlfile path for knowledge. In my case, the all Datafiles location is: “<strong>/u01/app/oracle/oradata/db11g/</strong>“</p><p></p><p></p><p><strong>Controlfile Location:</strong></p><p></p><p></p><pre class="wp-block-code"><code>/u01/app/oracle/oradata/db11g/control01.ctl/u01/app/oracle/fast_recovery_area/db11g/control02.ctl/u01/app/oracle/control03.ctl</code></pre><p></p><p></p><p>Audit file Location: “<strong>/u01/app/oracle/admin/db11g/adump/</strong>“</p><p></p><p></p><p>Now i’m going to taking Database full Backup with controlfile and spfile using RMAN.</p><p></p><p></p><p><strong>Before executing the backup command, must be checked control file auto backup on or not if not then configure it otherwise you need to take control file backup separately, in my case-control file auto backup is on.</strong></p><p></p><p></p><pre class="wp-block-code"><code>RMAN&gt; backup database plus archivelog;</code></pre><p></p><p></p><p>Once your database backup completed successfully, <strong>Now copy the </strong>above backup on New server with a password file if forget to copy the password file then you need to create a <strong>password manually.</strong></p><p></p><p></p><p>The Newly configured server must have install Oracle binary. Check here how to install Oracle on Linux.</p><p></p><p></p><h2>We have two ways to restore RMAN Backup</h2><p></p><p></p><ol><li><strong>With the </strong>same directory structure as our production environment.</li><li>You don’t want to follow the same directory structure then use the <strong>SET NEWNAME parameter.</strong></li></ol><p></p><p></p><p>After copying the RMAN Backup we need to create few directories which are required if you want the same directory structure as your production otherwise you can ignore safely and go with the second method.</p><p></p><p></p><p>In my case i’m going with first method.</p><p></p><p></p><pre class="wp-block-code"><code>mkdir -p /u01/app/oracle/admin/db11g/adump/mkdir -p /u01/app/oracle/oradata/db11g/mkdir -p /u01/app/oracle/fast_recovery_area/db11g/</code></pre><p></p><p></p><p>After creating above directories now we start the restoration steps, just follow me.</p><p></p><p></p><p><strong>Step-1.</strong> Copy spfile and passwordfile on it’s real location.</p><p></p><p></p><pre class="wp-block-code"><code>$cp /u01/backup/spfiledb11g.ora /u01/app/oracle/product/11.2.0.4/db_1/dbs/$cp /u01/backup/orapwdb11g /u01/app/oracle/product/11.2.0.4/db_1/dbs/</code></pre><p></p><p></p><p>After copying above both files now create a pfile using spfile and check all directory structure, if any directory not available then create it.</p><p></p><p></p><p><strong>Step-2. </strong>Now start Database at nomount stage.</p><p></p><p></p><pre class="wp-block-code"><code>$sqlplus / as sysdbaSQL&gt; startup nomount</code></pre><p></p><p></p><h2>Restore Controlfile from RMAN backup</h2><p></p><p></p><p>Now connect with RMAN and restore controlfile from controlfile Backup using following.</p><p></p><p></p><pre class="wp-block-code"><code>$ rman target/RMAN&gt; restore controlfile from ‘/u01/backup/o1_mf_s_1013679379_glqyxx3b_.bkp’;Starting restore at 15-JUL-19using target database control file instead of recovery catalogallocated channel: ORA_DISK_1channel ORA_DISK_1: SID=20 device type=DISKchannel ORA_DISK_1: restoring control filechannel ORA_DISK_1: restore complete, elapsed time: 00:00:03output file name=/u01/app/oracle/oradata/db11g/control01.ctloutput file name=/u01/app/oracle/fast_recovery_area/db11g/control02.ctloutput file name=/u01/app/oracle/control03.ctlFinished restore at 15-JUL-19</code></pre><p></p><p></p><p>After restoration of controlfile now mount the Database</p><p></p><p></p><pre class="wp-block-code"><code>RMAN&gt; alter database mount;database mountedreleased channel: ORA_DISK_1</code></pre><p></p><p></p><h2>Restore Database from RMAN Backup</h2><p></p><p></p><p><strong>Step-3. Now Catalog the Database Database start the restoration</strong>.</p><p></p><p></p><pre class="wp-block-code"><code>RMAN&gt; catalog start with ‘/u01/backup/’;Do you really want to catalog the above files (enter YES or NO)? yes</code></pre><p></p><p></p><p>After catalog, start restoration of the database.</p><p></p><p></p><pre class="wp-block-code"><code>RMAN&gt; restore database;</code></pre><p></p><p></p><p>Once restoration completed recover the database.</p><p></p><p></p><p><strong>Step-4. Run Last Command “Recover Database”</strong></p><p></p><p></p><pre class="wp-block-code"><code>RMAN&gt; recover database;Starting recover at 15-JUL-19using channel ORA_DISK_1starting media recoveryunable to find archived logarchived log thread=1 sequence=32RMAN-00571: ===========================================================RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============RMAN-00571: ===========================================================RMAN-03002: failure of recover command at 07/15/2019 17:26:11RMAN-06054: media recovery requesting unknown archived log for thread 1 with sequence 32 and starting SCN of 1505852</code></pre><p></p><p></p><p>The above error is common, due to missing archive, we do not restore Archive files in this restoration. Now Exit from the RMAN prompt and connect with the SQL prompt.</p><p></p><p></p><p><strong>Step-5. </strong>Connect with SQL prompt and open your database.</p><p></p><p></p><pre class="wp-block-code"><code>$ sqlplus / as sysdbaSQL&gt; alter database open;alter database open*ERROR at line 1:ORA-01589: must use RESETLOGS or NORESETLOGS option for database open</code></pre><p></p><p></p><p><strong>After restoration we need to open database with RESETLOGS.</strong></p><p></p><p></p><pre class="wp-block-code"><code>SQL&gt; alter database open resetlogs;</code></pre><p></p><p></p><p><strong>Congratulation you have successfully restore Database on a Newly created server.</strong> Please write in comment box if you learn how to Restore RMAN Backup with a Different Database Name.</p><p></p><p></p><p><strong>Connect with me on:</strong></p><p></p><p></p><p><strong>Facebook: </strong><a href="https://www.facebook.com/duongtrung2103" target="_blank" rel="noreferrer noopener">https://www.facebook.com/duongtrung2103</a><strong><br>YouTube:</strong><a href="https://www.youtube.com/c/TrungDuongfull" target="_blank" rel="noreferrer noopener">https://www.youtube.com/c/TrungDuongfull</a></p><p></p></div><footer><div class="post__tags-share"><aside class="post__share"></aside></div></footer></div></article></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><a href="https://ddtrungit.github.io/storing-rman-output-in-a-logfile/index.html" class="c-card__image"><img src="https://ddtrungit.github.io/media/posts/65/rman-interview-questions-1.jpg" srcset="https://ddtrungit.github.io/media/posts/65/responsive/rman-interview-questions-1-xs.jpg 300w, https://ddtrungit.github.io/media/posts/65/responsive/rman-interview-questions-1-sm.jpg 480w, https://ddtrungit.github.io/media/posts/65/responsive/rman-interview-questions-1-md.jpg 768w, https://ddtrungit.github.io/media/posts/65/responsive/rman-interview-questions-1-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="500" width="900" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://ddtrungit.github.io/tags/oracle/index.html">Oracle</a></div><h3 class="c-card__title"><a href="https://ddtrungit.github.io/storing-rman-output-in-a-logfile/index.html" class="invert">Storing RMAN output in a logfile</a></h3></header></div></article><article class="c-card"><a href="https://ddtrungit.github.io/how-to-check-rman-backup-status-and-timings/index.html" class="c-card__image"><img src="https://ddtrungit.github.io/media/posts/64/rman-interview-questions.jpg" srcset="https://ddtrungit.github.io/media/posts/64/responsive/rman-interview-questions-xs.jpg 300w, https://ddtrungit.github.io/media/posts/64/responsive/rman-interview-questions-sm.jpg 480w, https://ddtrungit.github.io/media/posts/64/responsive/rman-interview-questions-md.jpg 768w, https://ddtrungit.github.io/media/posts/64/responsive/rman-interview-questions-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="500" width="900" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://ddtrungit.github.io/tags/oracle/index.html">Oracle</a></div><h3 class="c-card__title"><a href="https://ddtrungit.github.io/how-to-check-rman-backup-status-and-timings/index.html" class="invert">How to check RMAN backup status and timings</a></h3></header></div></article><article class="c-card"><a href="https://ddtrungit.github.io/how-to-restore-archive-logs-from-rman-backup/index.html" class="c-card__image"><img src="https://ddtrungit.github.io/media/posts/63/maxresdefault.jpg" srcset="https://ddtrungit.github.io/media/posts/63/responsive/maxresdefault-xs.jpg 300w, https://ddtrungit.github.io/media/posts/63/responsive/maxresdefault-sm.jpg 480w, https://ddtrungit.github.io/media/posts/63/responsive/maxresdefault-md.jpg 768w, https://ddtrungit.github.io/media/posts/63/responsive/maxresdefault-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="720" width="1280" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://ddtrungit.github.io/tags/oracle/index.html">Oracle</a></div><h3 class="c-card__title"><a href="https://ddtrungit.github.io/how-to-restore-archive-logs-from-rman-backup/index.html" class="invert">How to restore archive logs from RMAN backup</a></h3></header></div></article><article class="c-card"><a href="https://ddtrungit.github.io/use-rman-in-noarchive/index.html" class="c-card__image"><img src="https://ddtrungit.github.io/media/posts/62/rman.jpg" srcset="https://ddtrungit.github.io/media/posts/62/responsive/rman-xs.jpg 300w, https://ddtrungit.github.io/media/posts/62/responsive/rman-sm.jpg 480w, https://ddtrungit.github.io/media/posts/62/responsive/rman-md.jpg 768w, https://ddtrungit.github.io/media/posts/62/responsive/rman-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="600" width="900" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://ddtrungit.github.io/tags/oracle/index.html">Oracle</a></div><h3 class="c-card__title"><a href="https://ddtrungit.github.io/use-rman-in-noarchive/index.html" class="invert">Use RMAN in NOARCHIVE</a></h3></header></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="https://facebook.com/duongtrung2103" aria-label="Facebook" class="facebook"><svg><use xlink:href="https://ddtrungit.github.io/assets/svg/svg-map.svg#facebook"/></svg></a></div><div class="footer__copyright">"DO THE THINGS YOU LOVE!"</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://ddtrungit.github.io/assets/js/scripts.min.js?v=d78591855e0ce96bf51239b499260e20"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>