<!DOCTYPE html><html lang="vi"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Ansible Là Gì? Hướng Dẫn Cài Đặt Ansible - TRUNG DUONG</title><meta name="robots" content="noindex,nofollow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="alternate" type="application/atom+xml" href="https://ddtrungit.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://ddtrungit.github.io/feed.json"><link rel="stylesheet" href="https://ddtrungit.github.io/assets/css/style.css?v=6ddec22a33b6e591633ba53617c15038"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://ddtrungit.github.io/ansible-la-gi-huong-dan-cai-dat-ansible/index.html"},"headline":"Ansible Là Gì? Hướng Dẫn Cài Đặt Ansible","datePublished":"2022-03-03T04:28","dateModified":"2022-06-13T14:24","image":{"@type":"ImageObject","url":"https://ddtrungit.github.io/media/posts/109/Ansible-la-gi-1.png","height":358,"width":750},"description":"Trong một môi trường với nhiều server thì ta sẽ có vô vàn thứ phải lo. Từ setup crontab, update&hellip;","author":{"@type":"Person","name":"Duong Dinh Trung","url":"https://ddtrungit.github.io/authors/dtrungit/"},"publisher":{"@type":"Organization","name":"Duong Dinh Trung","logo":{"@type":"ImageObject","url":"https://ddtrungit.github.io/media/website/Background_2.png","height":800,"width":834}}}</script></head><body><header class="header" id="js-header"><a href="https://ddtrungit.github.io/index.html" class="logo"><img src="https://ddtrungit.github.io/media/website/Background_2.png" alt="TRUNG DUONG"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://ddtrungit.github.io/index.html" target="_self">Home</a></li><li><a href="https://ddtrungit.github.io/gioi-thieu/index.html" target="_self">About</a></li><li><a href="https://ddtrungit.github.io/tags/ansible/index.html" target="_self">Ansible</a></li><li><a href="https://ddtrungit.github.io/tags/aws/index.html" target="_self">AWS</a></li><li><a href="https://ddtrungit.github.io/tags/oracle/index.html" target="_self">Oracle</a></li><li><a href="https://ddtrungit.github.io/tags/linux/index.html" target="_self">Linux</a></li><li><a href="https://ddtrungit.github.io/tags/zimbra/index.html" target="_self">Zimbra</a></li><li><a href="https://ddtrungit.github.io/tags/tip/index.html" target="_self">TIP</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://ddtrungit.github.io/tags/ansible/index.html" class="post__maintag">Ansible</a><h1 class="post__title">Ansible Là Gì? Hướng Dẫn Cài Đặt Ansible</h1><div class="post__meta"><div class="post__author">By <a href="https://ddtrungit.github.io/authors/dtrungit/index.html" class="invert" rel="author" title="Duong Dinh Trung">Duong Dinh Trung</a></div></div></header><figure class="post__featured-image"><img src="https://ddtrungit.github.io/media/posts/109/Ansible-la-gi-1.png" srcset="https://ddtrungit.github.io/media/posts/109/responsive/Ansible-la-gi-1-xs.png 300w, https://ddtrungit.github.io/media/posts/109/responsive/Ansible-la-gi-1-sm.png 480w, https://ddtrungit.github.io/media/posts/109/responsive/Ansible-la-gi-1-md.png 768w, https://ddtrungit.github.io/media/posts/109/responsive/Ansible-la-gi-1-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="358" width="750" alt=""></figure><div class="post__inner"><div class="post__entry"><p>Trong một môi trường với nhiều server thì ta sẽ có vô vàn thứ phải lo. Từ setup crontab, update các gói phần mềm mới, deploy ứng dụng mới, chỉnh sửa file cấu hình…. Những công việc này tuy không khó, nhưng rất mất thời gian của những người quản trị (SysAdmin/SysEngineer/DevOps). Vậy có cách nào để tự động hóa những thao tác nhàm chán, lặp đi lặp lại này không?</p><p><em>“Cùng một việc mà làm quá 2 lần thì có gì đó không ổn rồi”</em><em> </em><em>Từ một giảng viên cũ từng dạy mình</em></p><p>Câu trả lời chính là ứng dụng những tool automation để quản trị hệ thống. Hiện nay có rất nhiều tool như vậy trên thị trường cụ thể như: <strong>Chef</strong>, <strong>Puppet</strong>, <strong>CFEngine</strong>, <strong>StackStorm</strong>, <strong>Ansible</strong>, <strong>SaltStack</strong>… Trong bài này, mình sẽ giới thiệu đến các bạn một công cụ rất mạnh mẽ trong việc quản trị hệ thống, đó chính là <strong>Ansible</strong>.</p><h2><span id="1_Gioi_thieu_Ansible"><strong>1. Giới thiệu Ansible</strong></span></h2><p>Như đã nói ở trên, <strong>Ansible</strong> là một công cụ dùng để tự động hóa việc cấu hình trên nhiều server. So với các công cụ khác với tính năng tương đương thì Ansible dễ học và dễ tiếp cận hơn rất nhiều. Cộng đồng người dùng cũng nhiều hơn so với các công cụ khác.</p><p>So sánh một vài thông số về <strong>Ansible, SaltStack, Chef, Puppet</strong> trên <strong>GitHub (11/2018)</strong></p><table width="100%"><tbody><tr><td width="20%"> </td><td width="20%"><strong>Ansible</strong></td><td width="20%"><strong>SaltStack</strong></td><td width="20%"><strong>Chef</strong></td><td width="20%"><strong>Puppet</strong></td></tr><tr><td width="20%"><strong>Số sao trên GitHub</strong></td><td width="20%">33,500</td><td width="20%">9,341</td><td width="20%">5,543</td><td width="20%">5,125</td></tr><tr><td width="20%"><strong>Số lượt fork</strong></td><td width="20%">13,338</td><td width="20%">4,366</td><td width="20%">2,268</td><td width="20%">2,049</td></tr><tr><td width="20%"><strong>Ngôn ngữ lâp trình</strong></td><td width="20%">Python</td><td width="20%">Python</td><td width="20%">Ruby</td><td width="20%">Ruby</td></tr><tr><td width="20%"><strong>Ngôn ngữ cấu hình</strong></td><td width="20%">YAML</td><td width="20%">YAML</td><td width="20%">Ruby DSL</td><td width="20%">Puppet DSL</td></tr></tbody></table><p>Có thể thấy Ansible là công cụ tự động hóa phổ biến nhất trên GitHub với số sao được người dùng bình chọn cho project này là 33,500 sao. <strong>Ansible</strong> cũng là tool dễ tiếp cận và làm quen do được build bằng Python và sử dụng file cấu hình theo dạng YAML (<strong>Y</strong>AML <strong>A</strong>in’t <strong>M</strong>arkup <strong>L</strong>anguage) dễ đọc và dễ hiểu.</p><h3><span id="Kien_truc"><a name="_Toc70061298"></a><strong>Kiến trúc</strong></span></h3><p>Ansible sử dụng kiến trúc agentless để giao tiếp với các máy khác mà không cần agent. Cơ bản nhất là giao tiếp thông qua giao thức SSH trên Linux, WinRM trên Windows hoặc giao tiếp qua chính API của thiết bị đó cung cấp.</p><figure class="alignnone wp-image-3598"><img loading="lazy" src="https://ddtrungit.github.io/media/posts/109/Ansible-1.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://ddtrungit.github.io/media/posts/109/responsive/Ansible-1-xs.png 300w, https://ddtrungit.github.io/media/posts/109/responsive/Ansible-1-sm.png 480w, https://ddtrungit.github.io/media/posts/109/responsive/Ansible-1-md.png 768w" sizes="(max-width: 825px) 100vw, 825px" srcset="https://ddtrungit.github.io/media/posts/109/Ansible-1.png 1024w, https://blog.vinahost.vn/wp-content/uploads/2021/05/Ansible-1-300x169.png 300w, https://blog.vinahost.vn/wp-content/uploads/2021/05/Ansible-1-768x434.png 768w" alt="" width="825" height="466"></figure><p>Ansible có thể giao tiếp với rất nhiều platform, OS và loại thiết bị khác nhau. Từ Ubuntu, CentOS, VMware, Windows cho tới AWS, Azure, các thiết bị mạng Cisco và Juniper….vân vân và mây mây….(hoàn toàn không cần agent khi giao tiếp).</p><p>Chính cách thiết kế này làm tăng tính tiện dụng của Ansible do không cần phải setup bảo trì agent trên nhiều host. Có thể coi đây là một thế mạnh của Ansible so với các công cụ có cùng chức năng như Chef, Puppet, SaltStack (Salt thì hỗ trợ cả 2 mode là agent và agentless, có thời gian thì mình sẽ viết 1 bài về Salt).</p><h3><span id="Ung_dung"><a name="_Toc70061299"></a><strong>Ứng dụng</strong></span></h3><p>Ansible có rất nhiều ứng dụng trong triển khai phần mềm và quản trị hệ thống.</p><ul><li><strong>Provisioning:</strong> Khởi tạo VM, container hàng loạt trong môi trường cloud dựa trên API (OpenStack, AWS, Google Cloud, Azure…)</li><li><strong>Configuration Management: </strong>Quản lý cấu hình tập trung các dịch vụ tập trung, không cần phải tốn công chỉnh sửa cấu hình trên từng server.</li><li><strong>Application Deployment:</strong> Deploy ứng dụng hàng loạt, quản lý hiệu quả vòng đời của ứng dụng từ giai đoạn dev cho tới production.</li><li><strong>Security &amp; Compliance:</strong> Quản lý các chính sách về an toàn thông tinmột cách đồng bộ trên nhiều môi trường và sản phẩm khác nhau (deploy policy, cấu hình firewall hàng loạt trên nhiều server…).</li></ul><h3><span id="Mot_so_thuat_ngu_co_ban"><a name="_Toc70061300"></a><strong>Một số thuật ngữ cơ bản</strong></span></h3><ul><li><strong>Controller Machine</strong>: Là máy cài Ansible, chịu trách nhiệm quản lý, điều khiển và gởi task tới các máy con cần quản lý.</li><li><strong>Inventory</strong>: Là file chứa thông tin các server cần quản lý. File này thường nằm tại đường dẫn /etc/ansible/hosts.</li><li><strong>Playbook</strong>: Là file chứa các task của Ansible được ghi dưới định dạng YAML. Máy controller sẽ đọc các task trong Playbook và đẩy các lệnh thực thi tương ứng bằng Python xuống các máy con.</li><li><strong>Task</strong>: Một block ghi tác vụ cần thực hiện trong playbook và các thông số liên quan. Ví dụ 1 playbook có thể chứa 2 task là: yum update và yum install vim.</li><li><strong>Module</strong>: Ansible có rất nhiều module, ví dụ như moduel yum là module dùng để cài đặt các gói phần mềm qua yum. Ansible hiện có hơn ….2000 module để thực hiện nhiều tác vụ khác nhau, bạn cũng có thể tự viết thêm các module của mình nếu muốn.</li><li><strong>Role</strong>: Là một tập playbook được định nghĩa sẵn để thực thi 1 tác vụ nhất định (ví dụ cài đặt LAMP stack).</li><li><strong>Play</strong>: là quá trình thực thi của 1 playbook</li><li><strong>Facts</strong>: Thông tin của những máy được Ansible điều khiển, cụ thể là thông tin về OS, network, system…</li><li><strong>Handlers</strong>: Dùng để kích hoạt các thay đổi của dịch vụ như start, stop service.</li></ul><h2><span id="2_Huong_dan_cai_dat"><a name="_Toc70061301"></a><strong>2. Hướng dẫn cài đặt</strong></span></h2><h3><span id="Cau_hinh_yeu_cau"><a name="_Toc70061302"></a><strong>Cấu hình yêu cầu</strong></span></h3><ul><li>Python 2.7 trở lên, Python 3.x thì càng tốt</li><li>Đối với các host Linux thì cần hỗ trợ SSH.</li><li>Đối với những host chạy Windows thì cần hỗ trợ WinRM.</li></ul><h3><span id="Cach_thuc_hoat_dong"><a name="_Toc70061303"></a><strong>Cách thức hoạt động</strong></span></h3><p>Giống như đa phần các phần mềm quản lý cấu hình tập trung khác. <strong>Ansible</strong> có 2 loại server là control machine và node. Control machine là máy có trách nhiệm quản lý các node con trong hệ thống. Đây cũng là máy lưu trữ các thông tin về các node, playbook và các script cần dùng để deploy trên các node khác qua giao thức SSH.</p><p>Để quản lý các node, <strong>Ansible</strong> sẽ gởi các module lệnh tới các node con qua SSH. Các module lệnh này sẽ được lưu trữ tạm thời trên các node con và giao tiếp với máy chủ <strong>Ansible</strong> bằng JSON. Khi đã thực thi xong tác vụ trên các máy này, các module đó sẽ được xóa đi. Các module này thường được lưu ở folder <strong>/root/.ansible</strong> hoặc <strong>/home/&lt;user&gt;/.ansible</strong>, tùy theo user mà <strong>Ansible</strong> dùng để quản lý các node con.</p><p>Khi <strong>Ansible</strong> ở chế độ rảnh, không có task để thực hiện máy chủ <strong>Ansible</strong> sẽ không chiếm dụng tài nguyên do <strong>Ansible</strong> không sử dụng trình daemon hoặc program chạy ở chế độ background. Chỉ khi nào thực thi lệnh thì <strong>Ansible</strong> mới sử dụng tài nguyên của hệ thống.</p><h2><span id="Cai_dat_Ansible">Cài <a name="_Toc70061304"></a><strong>đặt Ansible</strong></span></h2><h3><span id="Ansible_Server_Control_Machine"><strong>Ansible Server – Control Machine</strong></span></h3><p>Ansible Server sẽ là nơi người quản trị chạy lệnh (ad-hoc/playbooks), Ansible engine sẽ xử lý các lệnh này và đẩy xuống các server slave tương ứng.</p><table><tbody><tr><td width="638"><pre># Install on CentOS$ sudo yum update$ sudo yum install epel-release$ sudo yum install ansible# Install on Ubuntu$ sudo apt update$ sudo apt install software-properties-common$ sudo apt-add-repository ppa:ansible/ansible$ sudo apt update$ sudo apt install ansible</pre></td></tr></tbody></table><p>Tạo file inventory chứa thông tin về các node cần quản lý:</p><table><tbody><tr><td width="638"><pre># vi /etc/ansible/hosts[group1]10.0.0.510.0.0.6</pre></td></tr></tbody></table><p><strong>Trên các Nodes con</strong></p><p>Cài đặt Python 2.7 trở lên và mở port SSH.</p><p>Chạy lệnh sau trên <strong>Control machine</strong> để kiểm tra các thông tin trên server:</p><table><tbody><tr><td width="638"><pre>#Kiem tra ket noi den cac nodes# ansible group1 -m ping#Kiem tra luong RAM trong tren cac nodes# ansible group1 -a "free -m" -u &lt;username&gt;#Kiem tra nhanh o cung tren cac nodes# ansible group1 -a "df -lh" -u &lt;username&gt;</pre></td></tr></tbody></table></div><footer><div class="post__tags-share"><aside class="post__share"></aside></div></footer></div></article></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><a href="https://ddtrungit.github.io/su-dung-ansible-thong-qua-bastion-host/index.html" class="c-card__image"><img src="https://ddtrungit.github.io/media/posts/110/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1.png" srcset="https://ddtrungit.github.io/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-xs.png 300w, https://ddtrungit.github.io/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-sm.png 480w, https://ddtrungit.github.io/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-md.png 768w, https://ddtrungit.github.io/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="368" width="1024" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://ddtrungit.github.io/tags/ansible/index.html">Ansible</a></div><h3 class="c-card__title"><a href="https://ddtrungit.github.io/su-dung-ansible-thong-qua-bastion-host/index.html" class="invert">Sử dụng Ansible thông qua Bastion Host</a></h3></header></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="https://facebook.com/duongtrung2103" aria-label="Facebook" class="facebook"><svg><use xlink:href="https://ddtrungit.github.io/assets/svg/svg-map.svg#facebook"/></svg></a></div><div class="footer__copyright">"DO THE THINGS YOU LOVE!"</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://ddtrungit.github.io/assets/js/scripts.min.js?v=d78591855e0ce96bf51239b499260e20"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>