<!DOCTYPE html><html lang="vi"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>[Kubernetes] Phần 8: Khái niệm Statefulset - TRUNG DUONG</title><meta name="robots" content="noindex,nofollow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#D73A42" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#D73A42"><meta name="apple-mobile-web-app-status-bar-style" content="#D73A42"><link rel="alternate" type="application/atom+xml" href="http://blog.dtrungit.ga/feed.xml"><link rel="alternate" type="application/json" href="http://blog.dtrungit.ga/feed.json"><link rel="shortcut icon" href="http://blog.dtrungit.ga/media/website/cropped-2019-09-16-32x32.png" type="image/x-icon"><link rel="shortcut icon" href="http://blog.dtrungit.ga/media/website/cropped-2019-09-16-32x32.png" type="image/x-icon"><link rel="stylesheet" href="http://blog.dtrungit.ga/assets/css/style.css?v=57332019283b097fa755d17b0d684374"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.dtrungit.ga/kubernetes-phan-8-khai-niem-statefulset/index.html"},"headline":"[Kubernetes] Phần 8: Khái niệm Statefulset","datePublished":"2022-06-15T15:26","dateModified":"2022-06-15T15:26","image":{"@type":"ImageObject","url":"http://blog.dtrungit.ga/media/posts/123/k8s.png","height":458,"width":816},"description":"1. Tổng quan Statefulset được sử dụng để quản trị một hoặc nhiều Pod. Vậy tại sao lại cần Statefulset khi đã&hellip;","author":{"@type":"Person","name":"Duong Dinh Trung","url":"http://blog.dtrungit.ga/authors/dtrungit/"},"publisher":{"@type":"Organization","name":"Duong Dinh Trung","logo":{"@type":"ImageObject","url":"http://blog.dtrungit.ga/media/website/Background_2.png","height":800,"width":834}}}</script></head><body><header class="header" id="js-header"><a href="http://blog.dtrungit.ga/index.html" class="logo"><img src="http://blog.dtrungit.ga/media/website/Background_2.png" alt="TRUNG DUONG"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="http://blog.dtrungit.ga/index.html" target="_self">Home</a></li><li><a href="http://blog.dtrungit.ga/lien-he/index.html" target="_self">Contact</a></li><li><a href="http://blog.dtrungit.ga/gioi-thieu/index.html" target="_self">About</a></li><li><a href="http://blog.dtrungit.ga/tags/aws/index.html" target="_self">AWS</a></li><li class="has-submenu"><a href="http://blog.dtrungit.ga/tags/linux/index.html" target="_self" aria-haspopup="true">Linux</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="http://blog.dtrungit.ga/tags/ansible/index.html" target="_self">Ansible</a></li><li><a href="http://blog.dtrungit.ga/tags/k8s/index.html" target="_self">Kubernetes</a></li><li><a href="http://blog.dtrungit.ga/tags/oracle/index.html" target="_self">Oracle</a></li><li><a href="http://blog.dtrungit.ga/tags/zimbra/index.html" target="_self">Zimbra</a></li><li><a href="http://blog.dtrungit.ga/tags/tip/index.html" target="_self">TIP</a></li></ul></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><h1 class="post__title">[Kubernetes] Phần 8: Khái niệm Statefulset</h1><div class="post__meta"><div class="post__author">By <a href="http://blog.dtrungit.ga/authors/dtrungit/index.html" class="invert" rel="author" title="Duong Dinh Trung">Duong Dinh Trung</a></div><div class="post__comments"><a href="http://blog.dtrungit.ga/kubernetes-phan-8-khai-niem-statefulset/index.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="http://blog.dtrungit.ga/assets/svg/svg-map.svg#comments"/></svg></a></div></div></header><figure class="post__featured-image"><img src="http://blog.dtrungit.ga/media/posts/123/k8s.png" srcset="http://blog.dtrungit.ga/media/posts/123/responsive/k8s-xs.png 300w, http://blog.dtrungit.ga/media/posts/123/responsive/k8s-sm.png 480w, http://blog.dtrungit.ga/media/posts/123/responsive/k8s-md.png 768w, http://blog.dtrungit.ga/media/posts/123/responsive/k8s-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="458" width="816" alt=""></figure><div class="post__inner"><div class="post__entry"><h2>1. Tổng quan</h2><p>Statefulset được sử dụng để quản trị một hoặc nhiều Pod.</p><p>Vậy tại sao lại cần <code>Statefulset</code> khi đã có <code>ReplicateSet</code>, <code>Deployment</code>?</p><h2><a href="https://github.com/lacoski/kubernetes-note/blob/main/docs/2.6-sfs-k8s.md#s%E1%BB%B1-kh%C3%A1c-bi%E1%BB%87t-gi%E1%BB%AFa-statefulset-v%C3%A0-replicateset"></a>2. Sự khác biệt giữa Statefulset và ReplicateSet</h2><p>Để hiểu rõ ta cần bắt đầu lại tự khái niệm:</p><ul><li>Ứng dụng dạng <code>stateless</code>:<ul><li>Các ứng dụng stateless thường là các service dụng <code>nginx, apache</code> hoặc chạy dạng HTTP Request. Gọi là stateless app vì mỗi request tới <code>nginx hoặc apache</code> chúng sẽ độc lập với nhau.</li><li>VD: Gửi HTTP tới Backend API, mỗi API sẽ độc lập không ảnh hưởng tới các API khác.</li></ul></li><li>Ứng dụng dạng <code>stateful</code>:<ul><li>Các ứng dụng stateful thường là các service dạng database, điển hình nhất là <code>mariadb, mysql</code>.</li><li>VD: Các database như <code>mariadb hoặc mysql</code> sẽ gặp phải vấn đề chỉ có thể ghi trên 1 node và ghi trên nhiều node.</li><li>Và các database dạng <code>mysql, mariadb</code> không thể scale hàng loạt bởi lý do cơ chế master slave, cơ chế ghi 1 đọc nhiều node ..</li></ul></li></ul><p>Qua đó, Deployment phù hợp hơn cho các ứng dụng dạng stateless, khi mà pod có thể sinh ra và mất đi linh hoạt</p><p><code>Statefulset</code> sinh ra khi phải quản lý pod chặt chẽ, ví dụ triển khai cụm mariadb master slave 3 node trên k8s.</p><figure class="wp-block-image size-full"><figure class="wp-image-505"><img loading="lazy" src="https://blog.devopsviet.com/wp-content/uploads/2021/08/pic1-7.png" data-is-external-image="true" sizes="(max-width: 938px) 100vw, 938px" srcset="https://blog.devopsviet.com/wp-content/uploads/2021/08/pic1-7.png 938w, https://blog.devopsviet.com/wp-content/uploads/2021/08/pic1-7-283x300.png 283w, https://blog.devopsviet.com/wp-content/uploads/2021/08/pic1-7-768x815.png 768w, https://blog.devopsviet.com/wp-content/uploads/2021/08/pic1-7-816x866.png 816w" alt="" width="938" height="996" loading="lazy"></figure></figure><figure class="wp-block-image size-large"><figure class="wp-image-506"><img loading="lazy" src="https://blog.devopsviet.com/wp-content/uploads/2021/08/pic2-1024x454.jpg" data-is-external-image="true" sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://blog.devopsviet.com/wp-content/uploads/2021/08/pic2-1024x454.jpg 1024w, https://blog.devopsviet.com/wp-content/uploads/2021/08/pic2-300x133.jpg 300w, https://blog.devopsviet.com/wp-content/uploads/2021/08/pic2-768x341.jpg 768w, https://blog.devopsviet.com/wp-content/uploads/2021/08/pic2-816x362.jpg 816w, https://blog.devopsviet.com/wp-content/uploads/2021/08/pic2.jpg 1159w" alt="" width="1024" height="454" loading="lazy"></figure></figure><h2>3. Khái niệm headless Service</h2><p>Thông thường khi tạo deployment, expose service ra bên ngoài chúng ta sẽ khởi tạo một Service để load-balance traffic xuống các Pod.</p><p>Vậy, đặt câu hỏi “Có cách để chúng ta có thể truy cập trực tiếp các Pod IP thông qua DNS endpoint nội bộ?”</p><p>Để giải quyết bài toán này, k8s sinh ra khái niệm “Headless Service”. Với Headless Service, chúng ta có thể kết nối trực tiếp với Pods.</p><p>Ví dụ, điển hình nhất cần sử dụng <code>Headless Service</code> là bài toán triển khai database trong k8s.</p><p>VD: Triển khai cụm database 3 node Master Slave Mariadb dạng <code>Statefulset</code>, thì việc đọc ghi chỉ thực hiện trên 1 node Master. Với trường này ta sẽ sử dụng <code>Headless service</code>.</p><figure class="wp-block-image size-full"><figure class="wp-image-507"><img loading="lazy" src="https://blog.devopsviet.com/wp-content/uploads/2021/08/pic3-4.png" data-is-external-image="true" sizes="(max-width: 938px) 100vw, 938px" srcset="https://blog.devopsviet.com/wp-content/uploads/2021/08/pic3-4.png 938w, https://blog.devopsviet.com/wp-content/uploads/2021/08/pic3-4-283x300.png 283w, https://blog.devopsviet.com/wp-content/uploads/2021/08/pic3-4-768x815.png 768w, https://blog.devopsviet.com/wp-content/uploads/2021/08/pic3-4-816x866.png 816w" alt="" width="938" height="996" loading="lazy"></figure></figure><h2>Nguồn</h2><figure class="wp-block-embed is-type-wp-embed is-provider-technology-diver wp-block-embed-technology-diver"><div class="wp-block-embed__wrapper"><div class="post__iframe"><iframe loading="lazy" width="600" height="533" class="wp-embedded-content" sandbox="allow-scripts" security="restricted" title="“Headless Service trong Kubernetes là gì ?” — Technology Diver" src="https://cuongquach.com/headless-service-trong-kubernetes-la-gi.html/embed#?secret=Qshyosx2Jm" data-secret="Qshyosx2Jm" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" data-origwidth="600" data-origheight="338" data-mce-fragment="1"></iframe></div></div></figure><p><a href="https://collabnix.github.io/kubelabs/StatefulSets101/#what-is-statefulset-and-how-is-it-different-from-deployment">https://collabnix.github.io/kubelabs/StatefulSets101/#what-is-statefulset-and-how-is-it-different-from-deployment</a></p></div><footer><div class="post__tags-share"><aside class="post__share"></aside></div><nav class="post__nav"><div class="post__nav__prev"><a class="post__nav__link" href="http://blog.dtrungit.ga/kubernetes-phan-7-khai-niem-services/index.html" rel="prev">Previous Post<h3 class="h6">[Kubernetes] Phần 7: Khái niệm Services</h3></a></div><div class="post__nav__next"><a class="post__nav__link" href="http://blog.dtrungit.ga/kubernetes-phan-9-khai-niem-daemonset/index.html" rel="prev">Next Post<h3 class="h6">[Kubernetes] Phần 9: Khái niệm DaemonSet</h3></a></div></nav></footer></div></article><div class="comments-area post__inner" id="comments"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div class="fb-comments" data-href="http://blog.dtrungit.ga/kubernetes-phan-8-khai-niem-statefulset/" data-width="100%" data-colorscheme="light" data-lazy="true" data-order-by="reverse_time" data-numposts="5"></div><noscript>Please enable JS to use the comments form.</noscript></div></div><div id="fb-root"></div><script type="text/javascript" async defer="defer" crossorigin="anonymous" src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v12.0">nonce="n4mWU9e7"</script></div></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><a href="http://blog.dtrungit.ga/kubernetes-phan-7-khai-niem-services/index.html" class="c-card__image"><img src="http://blog.dtrungit.ga/media/posts/122/k8s.png" srcset="http://blog.dtrungit.ga/media/posts/122/responsive/k8s-xs.png 300w, http://blog.dtrungit.ga/media/posts/122/responsive/k8s-sm.png 480w, http://blog.dtrungit.ga/media/posts/122/responsive/k8s-md.png 768w, http://blog.dtrungit.ga/media/posts/122/responsive/k8s-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="458" width="816" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="http://blog.dtrungit.ga/tags/k8s/index.html">K8s</a></div><h3 class="c-card__title"><a href="http://blog.dtrungit.ga/kubernetes-phan-7-khai-niem-services/index.html" class="invert">[Kubernetes] Phần 7: Khái niệm Services</a></h3></header><p class="c-card__text">1. Tổng quan Về mặt lý thuyết, ta có thể expose để người dùng kết nối trực tiếp tới Pod.</p><footer class="c-card__meta"><div class="c-card__comments"><a href="http://blog.dtrungit.ga/kubernetes-phan-7-khai-niem-services/index.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="http://blog.dtrungit.ga/assets/svg/svg-map.svg#comments"/></svg></a></div></footer></div></article><article class="c-card"><a href="http://blog.dtrungit.ga/kubernetes-phan-6-khai-niem-scheduling/index.html" class="c-card__image"><img src="http://blog.dtrungit.ga/media/posts/121/k8s.png" srcset="http://blog.dtrungit.ga/media/posts/121/responsive/k8s-xs.png 300w, http://blog.dtrungit.ga/media/posts/121/responsive/k8s-sm.png 480w, http://blog.dtrungit.ga/media/posts/121/responsive/k8s-md.png 768w, http://blog.dtrungit.ga/media/posts/121/responsive/k8s-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="458" width="816" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="http://blog.dtrungit.ga/tags/k8s/index.html">K8s</a></div><h3 class="c-card__title"><a href="http://blog.dtrungit.ga/kubernetes-phan-6-khai-niem-scheduling/index.html" class="invert">[Kubernetes] Phần 6: Khái niệm Scheduling</a></h3></header><p class="c-card__text">Tổng quan Kubernetes Scheduler (kube-scheduler) là thành phần core trong k8s. Thành phần này sẽ tính toán để tìm node&hellip;</p><footer class="c-card__meta"><div class="c-card__comments"><a href="http://blog.dtrungit.ga/kubernetes-phan-6-khai-niem-scheduling/index.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="http://blog.dtrungit.ga/assets/svg/svg-map.svg#comments"/></svg></a></div></footer></div></article><article class="c-card"><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="http://blog.dtrungit.ga/tags/k8s/index.html">K8s</a></div><h3 class="c-card__title"><a href="http://blog.dtrungit.ga/kubernetes-phan-5-khai-niem-deployment/index.html" class="invert">[Kubernetes] Phần 5: Khái niệm Deployment</a></h3></header><p class="c-card__text">Tổng quan Với ReplicateSet, ta chỉ có thể tăng giảm số lượng Pod, nhưng vấn để của RS là không&hellip;</p><footer class="c-card__meta"><div class="c-card__comments"><a href="http://blog.dtrungit.ga/kubernetes-phan-5-khai-niem-deployment/index.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="http://blog.dtrungit.ga/assets/svg/svg-map.svg#comments"/></svg></a></div></footer></div></article><article class="c-card"><a href="http://blog.dtrungit.ga/kubernetes-phan-4-khai-niem-replicateset/index.html" class="c-card__image"><img src="http://blog.dtrungit.ga/media/posts/119/k8s.png" srcset="http://blog.dtrungit.ga/media/posts/119/responsive/k8s-xs.png 300w, http://blog.dtrungit.ga/media/posts/119/responsive/k8s-sm.png 480w, http://blog.dtrungit.ga/media/posts/119/responsive/k8s-md.png 768w, http://blog.dtrungit.ga/media/posts/119/responsive/k8s-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="458" width="816" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="http://blog.dtrungit.ga/tags/k8s/index.html">K8s</a></div><h3 class="c-card__title"><a href="http://blog.dtrungit.ga/kubernetes-phan-4-khai-niem-replicateset/index.html" class="invert">[Kubernetes] Phần 4: Khái niệm ReplicateSet</a></h3></header><p class="c-card__text">Tổng quan ReplicateSet được sử dụng để duy trì một tập replicate các Pod ổn định theo thời gian ReplicateSet&hellip;</p><footer class="c-card__meta"><div class="c-card__comments"><a href="http://blog.dtrungit.ga/kubernetes-phan-4-khai-niem-replicateset/index.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="http://blog.dtrungit.ga/assets/svg/svg-map.svg#comments"/></svg></a></div></footer></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="https://facebook.com/duongtrung2103" aria-label="Facebook" class="facebook"><svg><use xlink:href="http://blog.dtrungit.ga/assets/svg/svg-map.svg#facebook"/></svg></a></div><div class="footer__copyright">"DO THE THINGS YOU LOVE!"</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="http://blog.dtrungit.ga/assets/js/scripts.min.js?v=d78591855e0ce96bf51239b499260e20"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>