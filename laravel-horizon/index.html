<!DOCTYPE html><html lang="vi"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Laravel Horizon - TRUNG DUONG</title><meta name="robots" content="noindex,nofollow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="alternate" type="application/atom+xml" href="https://ddtrungit.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://ddtrungit.github.io/feed.json"><link rel="shortcut icon" href="https://ddtrungit.github.io/media/website/cropped-2019-09-16-32x32.png" type="image/x-icon"><link rel="shortcut icon" href="https://ddtrungit.github.io/media/website/cropped-2019-09-16-32x32.png" type="image/x-icon"><link rel="stylesheet" href="https://ddtrungit.github.io/assets/css/style.css?v=4becd99c93342dd7c117b97188f052e6"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://ddtrungit.github.io/laravel-horizon/index.html"},"headline":"Laravel Horizon","datePublished":"2021-05-17T07:55","dateModified":"2022-06-13T14:26","image":{"@type":"ImageObject","url":"https://ddtrungit.github.io/media/posts/100/3d6e5720-f4e6-4dde-bd3e-f9703a2d8375.png","height":417,"width":825},"description":"Laravel Horizon là một hệ thống quản lý, cấu hình Redis queues hoàn toàn mới, vô cùng đẹp mắt, open source&hellip;","author":{"@type":"Person","name":"Duong Dinh Trung","url":"https://ddtrungit.github.io/authors/dtrungit/"},"publisher":{"@type":"Organization","name":"Duong Dinh Trung","logo":{"@type":"ImageObject","url":"https://ddtrungit.github.io/media/website/Background_2.png","height":800,"width":834}}}</script></head><body><header class="header" id="js-header"><a href="https://ddtrungit.github.io/index.html" class="logo"><img src="https://ddtrungit.github.io/media/website/Background_2.png" alt="TRUNG DUONG"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://ddtrungit.github.io/index.html" target="_self">Home</a></li><li><a href="https://ddtrungit.github.io/lien-he/index.html" target="_self">Contact</a></li><li><a href="https://ddtrungit.github.io/gioi-thieu/index.html" target="_self">About</a></li><li><a href="https://ddtrungit.github.io/tags/ansible/index.html" target="_self">Ansible</a></li><li><a href="https://ddtrungit.github.io/tags/aws/index.html" target="_self">AWS</a></li><li><a href="https://ddtrungit.github.io/tags/oracle/index.html" target="_self">Oracle</a></li><li><a href="https://ddtrungit.github.io/tags/linux/index.html" target="_self">Linux</a></li><li><a href="https://ddtrungit.github.io/tags/zimbra/index.html" target="_self">Zimbra</a></li><li><a href="https://ddtrungit.github.io/tags/tip/index.html" target="_self">TIP</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><h1 class="post__title">Laravel Horizon</h1><div class="post__meta"><div class="post__author">By <a href="https://ddtrungit.github.io/authors/dtrungit/index.html" class="invert" rel="author" title="Duong Dinh Trung">Duong Dinh Trung</a></div></div></header><figure class="post__featured-image"><img src="https://ddtrungit.github.io/media/posts/100/3d6e5720-f4e6-4dde-bd3e-f9703a2d8375.png" srcset="https://ddtrungit.github.io/media/posts/100/responsive/3d6e5720-f4e6-4dde-bd3e-f9703a2d8375-xs.png 300w, https://ddtrungit.github.io/media/posts/100/responsive/3d6e5720-f4e6-4dde-bd3e-f9703a2d8375-sm.png 480w, https://ddtrungit.github.io/media/posts/100/responsive/3d6e5720-f4e6-4dde-bd3e-f9703a2d8375-md.png 768w, https://ddtrungit.github.io/media/posts/100/responsive/3d6e5720-f4e6-4dde-bd3e-f9703a2d8375-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="417" width="825" alt=""></figure><div class="post__inner"><div class="post__entry"><div style="direction: ltr; border-width: 100%;"><div style="direction: ltr; margin-top: 0in; margin-left: 0in; width: 7.1in;"><div style="direction: ltr; margin-top: 0in; margin-left: 0in; width: 7.1in;"><p style="margin: 0in;"><a href="https://horizon.laravel.com/"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Laravel Horizon</span></a><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;"> là một hệ thống quản lý, cấu hình Redis queues hoàn toàn mới, vô cùng đẹp mắt, open source và miễn phí cho toàn bộ cộng đồng Laravel. Laravel Horizon sẽ được tung ra bản beta vào ngày mai (27/07/2017).</span></p><p style="margin: 0in; font-family: 'Open Sans'; font-size: 20.0pt; color: #292b2c;"><span style="font-weight: bold; background: white;">Dashboard (Bảng quản lý)</span></p><p style="margin: 0in;"><img loading="lazy" src="https://ddtrungit.github.io/media/posts/100/HsLZAVZMaDUAAAAASUVORK5CYII=" alt="coe  Laravel Horizon  @ Dashboard  Q  Monitoring  Recent Jobs  @ Failed  Overview  JOBS PER MINUTE  27  TOTAL PROCESSES  JOBS PAST HOUR  1620  MAX WAIT TIME  emails  FAILED JOBS PAST HOUR  5  MAX RUNTIME " width="480" height="242"></p><p style="margin: 0in;"><a href="https://horizon.laravel.com/"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Horizon</span></a><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;"> dashboard chỉ chạy trên một page duy nhất rất đẹp sử dụng Vue.js, được cài đặt trực tiếp tới ứng dụng của bạn một cách đơn giản thông qua composer </span><span style="font-family: SFMono-Regular; font-size: 12.0pt; color: #1b1b1b; background: #EEEEEE;">composer require laravel/horizon</span><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;">. Nó cung cấp bảng thống kê real-time về queue workloads, recent jobs, failed jobs, job retries, throughput và runtime metrics, và process counts. Việc authentication tới dashboard được controlled bằng cách gọi callback registered thông qua </span><span style="font-family: SFMono-Regular; font-size: 12.0pt; color: #1b1b1b; background: #EEEEEE;">Horizon::auth</span><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;">, cho phép bạn có full control truy cập tới dashboard.</span></p><p style="margin: 0in; font-family: 'Open Sans'; font-size: 20.0pt; color: #292b2c;"><span style="font-weight: bold; background: white;">Configuration (Cấu hình)</span></p><p style="margin: 0in;"><a href="https://horizon.laravel.com/"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Horizon</span></a><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;"> là một cách mới tuyệt vời để cấu hình queues cho Laravel. Tương tự như Laravel's schedular, tất cả queue worker được cấu hình trong code:</span></p><p style="margin: 0in; color: #1b1b1b;"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Có configuration này trong code có nghĩa là nó nằm dưới sự kiểm soát của source code, làm cho nó trở nên đơn giản khi làm việc với dev team. Trong file </span><span style="font-family: SFMono-Regular; font-size: 12.0pt; background: #EEEEEE;">config/horizon.php</span><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">, Tôi có thể cấu số lượng processes sẽ được xử lý, queue timeouts, và các thiết lập khác mà tôi muốn truyền vào </span><span style="font-family: SFMono-Regular; font-size: 12.0pt; background: #EEEEEE;">queue:work</span><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;"> Artisan command.</span></p><p style="margin: 0in; color: #1b1b1b;"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Sau, để start các queue workers, tôi chỉ cần chạy một command duy nhất và đơn giản </span><span style="font-family: SFMono-Regular; font-size: 12.0pt; background: #EEEEEE;">command: php artisan horizon</span><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">. Không cần thêm một command nào khác. Command này sẽ đọc Horizon configuration và cung cấp toàn bộ những gì cần thiết cho các worker processes.</span></p><p style="margin: 0in; font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b;"><span style="background: white;">Một khi Horizon đã được cài đặt và deploy lên production, bạn có thể modify toàn bộ worker configuration bằng cách modify configuration file và deploy lại.</span></p><p style="margin: 0in; font-family: 'Open Sans'; font-size: 20.0pt; color: #292b2c;"><span style="font-weight: bold; background: white;">Failed Jobs (Các Queue Jobs bị lỗi trong quá trình thực thi)</span></p><p style="margin: 0in;"><a href="https://horizon.laravel.com/"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Horizon</span></a><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;"> cung cấp một giao diện rõ ràng, chi tiết để xem xét và retry các failed jobs. Bạn có thể xem exception stack trace, tags, và recent retries. Thật là tuyệt vời khi recent job retries được hiển thị trực tiếp trên trang chi tiết failed job. Bởi vì recent retries được liên kết với failed job ban đầu, bạn không cần phải sử dụng câu lệnh </span><span style="font-family: SFMono-Regular; font-size: 12.0pt; color: #1b1b1b; background: #EEEEEE;">queue:retry</span><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;"> ngay sau khi phát hiện failed job thông qua console và đợi retry kết thúc success hay fail một lần nữa:</span></p><p style="margin: 0in;"><img loading="lazy" src="https://ddtrungit.github.io/media/posts/100/fu3fj4+DsAAADw2ghb2wcPHkgkkhfbcCOrFUdisTg9Pf3hw4e5iQ0AAABeObKRTUhISE5OzszMlEqlL7bVRlYrjsjsQuJaVlZWRkZGOgAAALw2JKWJRCKJRPJiBxbIkdWKLTLHSHNIAAAA4DUQtrMy3gtvspHVAAAAAIouZDUAAACAogtZDQAAAKDoQlYDAAAAKLr+D3ps26+o6H1EAAAAAElFTkSuQmCC" alt="Dashboard  Q  Monitoring  Metrics  Recent Jobs  @ Failed  App\Jobs\FailingTask  ID  Tags  Failed Time  Error  Data  1  default  App\Video:5  2017-07-25 14:53:08  Exception: Something went wrong in  (Users,'Taylor/Documents/Code/Horizon/app/app/Jobs/Failing•  Stack trace:  #0 [internal function]:  #1 /Users/Taylor/Documents/Code/Horizon/app/vendor  minate/Container/BoundMethod.php(29): call_user_func_array  #2 /lJsersrraylor/Docurnents/C0de/Horizon/app/vendor/laravc  minate/Container/BoundMethod.php(87): Illuminate\Containe1  #3 /Users/Taylor/Documents/Code/Horizon/app/vendor  minate/Container/BoundMethod.php(31): Illuminate\Containe1  Bound Arr;  #4 'Users,'Taylor/Docurnents/C0de/Horizon/app/vendor/laravc  minate/Container/Container.php(549):  Array, Array, NULL)  #5 /Users/Taylor/Documents/Code/Horizon/app/vendor/laravc  minate/Bus/Dispatcher.php(94):  •video&quot; :  • •job•:  •connection- : null,  •queue - : nun, " width="480" height="567"></p><p style="margin: 0in; font-family: 'Open Sans'; font-size: 20.0pt; color: #292b2c;"><span style="font-weight: bold; background: white;">Tag Monitoring</span></p><p style="margin: 0in;"><a href="https://horizon.laravel.com/"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Horizon</span></a><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;"> cho phép bạn gán "tags" cho các jobs, bao gồm mailables, broadcasts, notifications, và queued listeners. Trên thực tế, Horizon sẽ tự động tag các jobs một cách thông minh và tự động tùy thuộc vào các Eloquent model gắn liền với job. Tính năng này giúp bạn có thể dễ dàng tìm kiếm các jobs của bạn thông qua các tags:</span></p><p style="margin: 0in;"><img loading="lazy" src="https://ddtrungit.github.io/media/posts/100/z8R7HrTai1XSQAAAABJRU5ErkJggg==" alt="Laravel Horizon  (2) Dashboard  Q Monitoring  Recent Jobs  G) Failed  Recent Jobs for &quot;first&quot;  All  Failed  AppUobs\Somethi ng  AppUobs\Something  AppUobs\Something  on  default  default  default  Tags  first, second  first, second  first, second  Queued At  14:41:01  14:41:01  14:41:01 " width="480" height="260"></p><p style="margin: 0in; font-family: 'Open Sans'; font-size: 20.0pt; color: #292b2c;"><span style="font-weight: bold; background: white;">Balancing (Cân bằng)</span></p><p style="margin: 0in;"><img loading="lazy" src="https://ddtrungit.github.io/media/posts/100/R6xwAAAABJRU5ErkJggg==" alt="Current Workload  Queue  default  Processes  Jobs  1683  Wait " width="480" height="150"></p><p style="margin: 0in;"><a href="https://horizon.laravel.com/"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Horizon</span></a><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;"> có thể tự động cân bằng các queue worker processes dựa trên lượng processes giữa các queues. Ví dụ, nếu queue “default” rỗng, nhưng queue “notifications” lại đầy, </span><a href="https://horizon.laravel.com/"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Horizon</span></a><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;"> có thể tự động phân bổ các workers tới queue “notifications” giúp cho các jobs được xử lý nhanh hơn.</span></p><p style="margin: 0in; font-family: 'Open Sans'; font-size: 13.5pt;"><span style="color: #1b1b1b; background: white;">Một khi queue đã bắt kịp, </span><a href="https://horizon.laravel.com/"><span style="background: white;">Horizon</span></a><span style="color: #1b1b1b; background: white;"> sẽ đảm bảo rằng các processes được phân phối lại một cách công bằng trên tất cả các queues.</span></p><p style="margin: 0in; font-family: 'Open Sans'; font-size: 20.0pt; color: #292b2c;"><span style="font-weight: bold; background: white;">Metrics</span></p><p style="margin: 0in;"><img loading="lazy" src="https://ddtrungit.github.io/media/posts/100/n9++yvi3oIRZAAAAABJRU5ErkJggg==" alt="Q  Laravel Horizon  Dashboard  Throughput - App\Jobs\RenderVideo  Monitoring  Metrics  Recent Jobs  Failed  100  Runtime - App\Jobs\RenderVideo  4 " width="480" height="415"></p><p style="margin: 0in;"><a href="https://horizon.laravel.com/"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Horizon</span></a><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;"> cung cấp biểu đồ throughput và runtime, cho phép bạn xem xu hướng throughput and runtime của từng job hoặc toàn bộ một queue. Những metrics snapshot được chụp lại bằng cách sử dụng command </span><span style="font-family: SFMono-Regular; font-size: 12.0pt; color: #1b1b1b; background: #EEEEEE;">horizon:snapshot</span><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;">, có thể được lên lịch để chạy mỗi phút bằng cách sử dụng Laravel’s built-in scheduler. Điều này cho phép bạn nhanh chóng tìm ra sự xuống cấp của performance sau khi deploy.</span></p><p style="margin: 0in; font-family: 'Open Sans'; font-size: 20.0pt; color: #292b2c;"><span style="font-weight: bold; background: white;">Notifications (Thông báo)</span></p><p style="margin: 0in;"><img loading="lazy" src="https://ddtrungit.github.io/media/posts/100/wdoRfdhxGv2MwAAAABJRU5ErkJggg==" alt="AT&amp;T  2:42 PM  +1 (203) 529-8198  The &quot;default&quot; queue on the &quot;redis&quot; " width="480" height="200"></p><p style="margin: 0in;"><a href="https://horizon.laravel.com/"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Horizon</span></a><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;"> gửi thông báo thông qua cả Slack và SMS khi queue của bạn quá đầy. Bạn có thể dễ dàng cấu hình ngưỡng thời gian chờ để xác định khi nào một thông báo sẽ được gửi. Điều này có nghĩa là bạn luôn ý thức được khi queue của bạn cần thêm workers. Khi bạn nhận được thông báo, cấu hình dựa trên code-driven của </span><a href="https://horizon.laravel.com/"><span style="font-family: 'Open Sans'; font-size: 13.5pt; background: white;">Horizon</span></a><span style="font-family: 'Open Sans'; font-size: 13.5pt; color: #1b1b1b; background: white;"> cho phép bạn thực hiện thay đổi cấu hình nhanh để thêm nhiều workers hơn.</span></p></div></div></div></div><footer><div class="post__tags-share"><aside class="post__share"></aside></div></footer></div></article></div></main><footer class="footer"><div class="footer__social"><a href="https://facebook.com/duongtrung2103" aria-label="Facebook" class="facebook"><svg><use xlink:href="https://ddtrungit.github.io/assets/svg/svg-map.svg#facebook"/></svg></a></div><div class="footer__copyright">"DO THE THINGS YOU LOVE!"</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://ddtrungit.github.io/assets/js/scripts.min.js?v=d78591855e0ce96bf51239b499260e20"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>