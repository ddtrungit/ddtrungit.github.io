<!DOCTYPE html><html lang="vi"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Upgrade zimbra 8.6 to 8.8 centos - TRUNG DUONG</title><meta name="robots" content="noindex,nofollow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="alternate" type="application/atom+xml" href="https://ddtrungit.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://ddtrungit.github.io/feed.json"><link rel="stylesheet" href="https://ddtrungit.github.io/assets/css/style.css?v=6ddec22a33b6e591633ba53617c15038"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://ddtrungit.github.io/upgrade-zimbra-86-to-88-centos/index.html"},"headline":"Upgrade zimbra 8.6 to 8.8 centos","datePublished":"2021-01-27T08:25","dateModified":"2022-06-13T14:33","image":{"@type":"ImageObject","url":"https://ddtrungit.github.io/media/posts/79/tai-xuong.png","height":157,"width":320},"description":"Trong trường hợp bạn muốn nâng cấp từ phiên bản thấp hơn (ví dụ như 8.6) lên 8.8, bạn cần&hellip;","author":{"@type":"Person","name":"Duong Dinh Trung","url":"https://ddtrungit.github.io/authors/dtrungit/"},"publisher":{"@type":"Organization","name":"Duong Dinh Trung","logo":{"@type":"ImageObject","url":"https://ddtrungit.github.io/media/website/Background_2.png","height":800,"width":834}}}</script></head><body><header class="header" id="js-header"><a href="https://ddtrungit.github.io/index.html" class="logo"><img src="https://ddtrungit.github.io/media/website/Background_2.png" alt="TRUNG DUONG"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://ddtrungit.github.io/index.html" target="_self">Home</a></li><li><a href="https://ddtrungit.github.io/gioi-thieu/index.html" target="_self">About</a></li><li><a href="https://ddtrungit.github.io/tags/ansible/index.html" target="_self">Ansible</a></li><li><a href="https://ddtrungit.github.io/tags/aws/index.html" target="_self">AWS</a></li><li><a href="https://ddtrungit.github.io/tags/oracle/index.html" target="_self">Oracle</a></li><li><a href="https://ddtrungit.github.io/tags/linux/index.html" target="_self">Linux</a></li><li><a href="https://ddtrungit.github.io/tags/zimbra/index.html" target="_self">Zimbra</a></li><li><a href="https://ddtrungit.github.io/tags/tip/index.html" target="_self">TIP</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://ddtrungit.github.io/tags/zimbra/index.html" class="post__maintag">Zimbra</a><h1 class="post__title">Upgrade zimbra 8.6 to 8.8 centos</h1><div class="post__meta"><div class="post__author">By <a href="https://ddtrungit.github.io/authors/dtrungit/index.html" class="invert" rel="author" title="Duong Dinh Trung">Duong Dinh Trung</a></div></div></header><figure class="post__featured-image"><img src="https://ddtrungit.github.io/media/posts/79/tai-xuong.png" srcset="https://ddtrungit.github.io/media/posts/79/responsive/tai-xuong-xs.png 300w, https://ddtrungit.github.io/media/posts/79/responsive/tai-xuong-sm.png 480w, https://ddtrungit.github.io/media/posts/79/responsive/tai-xuong-md.png 768w, https://ddtrungit.github.io/media/posts/79/responsive/tai-xuong-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="157" width="320" alt=""></figure><div class="post__inner"><div class="post__entry"><p></p><figure class="wp-block-embed"><div class="wp-block-embed__wrapper">https://zimbra.github.io/installguides/work-in-progress/upgrade.html</div></figure><p></p><p></p><p>Trong trường hợp bạn muốn nâng cấp từ phiên bản thấp hơn (ví dụ như 8.6) lên 8.8, bạn cần lưu ý các vấn đề sau:</p><p></p><p></p><ul><li>Phiên bản 8.8 bắt buộc phải có Proxy và memcached =&gt; cần cài đặt Proxy/Memcache cho 8.6 trước khi nâng cấp lên 8.8.</li><li>Sau khi cài đặt proxy, để Mailboxd server log được các địa chỉ IP gốc của client, cần sử dụng X-Forwarded-For.</li><li>Sau khi nâng cấp, Zimbra 8.8 sử dụng module NG Backup (Backup Plus), HSM Plus, Admin Plus và Mobile Plus thay cho các module cũ.</li></ul><p></p><p></p><p>Bước 1: Tiến hành backup toàn bộ hệ thống. Cách đơn giản nhất nếu bạn đang sử dụng môi trường ảo hóa là lấy snapshot máy ảo. Cấu hình firewall chặn luồng mail đến server.</p><p></p><p></p><p>Bước 2: Cài đặt Proxy và Memcached.</p><p></p><p></p><p>Tải bản zimbra 8.6 từ Zimbra, bung nén và tiến hành cài đặt. Bạn sẽ được hỏi có muốn cài đặt Proxy và Memcached hay không. Chọn Y.</p><p></p><p></p><p><em>Do you wish to upgrade? [Y] Y </em></p><p></p><p></p><p><em>Install zimbra-memcached [N] Y </em></p><p></p><p></p><p><em>Install zimbra-proxy [N] Y</em></p><p></p><p></p><p>Bước 3: cấu hình proxy</p><p></p><p></p><p><em>su – zimbra</em></p><p></p><p></p><p><em>./libexec/zmproxyconfig -e -w -o -a 8080: 80: 8443: 443 -x both -H `zmhostname` #cấu hình web proxy.</em></p><p></p><p></p><p><em>./libexec/zmproxyconfig -e -m -o -i 7143: 143: 7993: 993 -p 7110: 110: 7995: 995 -H `zmhostname` #cấu hình imap và pop3 proxy.</em></p><p></p><p></p><p><em>zmcontrol restart</em></p><p></p><p></p><p><em>zmprov ms `zmhostname` zimbraMailReferMode reverse-proxied #hướng dẫn mailboxd server sử dụng proxy.</em></p><p></p><p></p><p><em>zmmailboxdctl restart</em></p><p></p><p></p><p>Bước 4: kiểm tra hệ thống hoạt động tốt.</p><p></p><p></p><p>Bước 5: Cài đặt 8.8</p><p></p><p></p><p>Tiến hành cài đặt bình thường, hệ thống sẽ hỏi bạn muốn upgrade từ 8.6 lên 8.8 không? Trả lời Y và tiến hành. Bạn chọn cài đặt NG-Module để sử dụng các module mới của Zimbra (Backup plus, HSM plus,…).</p><p></p><p></p><p><em>Install zimbra-network-modules-ng [Y]</em></p><p></p><p></p><p>Bước 6: sử dụng X-Forwared-For</p><p></p><p></p><p><em>su – zimbra</em></p><p></p><p></p><p><em>zmprov mcf +zimbraMailTrustedIP 127.0.0.1 +zimbraMailTrustedIP </em><em>10.11.12.13</em></p><p></p><p></p><p>Địa chỉ 10.11.12.13 là địa chỉ IP của mail server.</p><p></p><p></p><p>Bước 7: có một số trường hợp sau khi nâng cấp xong bạn sẽ không thấy NG-Module hiển thị trong giao diện quản trị. Tiến hành enable module này:</p><p></p><p></p><p><em>zmprov ms `zmhostname` zimbraNetworkModulesNGEnabled TRUE</em></p><p></p><p></p><p>Bước 8: Chỉnh sửa DDOS Filter tránh lỗi cảnh báo NG-Module.</p><p></p><p></p><p>Ta sẽ tăng mức ngưỡng DDOS Filter lên.</p><p></p><p></p><p><em>zmprov mcf zimbraHttpDosFilterDelayMillis 20</em></p><p></p><p></p><p><em>zmprov mcf zimbraHttpDosFilterMaxRequestsPerSec 100</em></p><p></p><p></p><p>Bước 9: update zimbra ssh key</p><p></p><p></p><p><em>zmupdateauthkeys</em></p><p></p><p></p><p>Bước 10: Mở lại firewall cho phép mail đổ về server, kiểm tra hệ thống hoạt động tốt.</p><p></p></div><footer><div class="post__tags-share"><aside class="post__share"></aside></div></footer></div></article></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><a href="https://ddtrungit.github.io/cac-buoc-rebuild-zimbra-server-ng-backup/index.html" class="c-card__image"><img src="https://ddtrungit.github.io/media/posts/80/tai-xuong.png" srcset="https://ddtrungit.github.io/media/posts/80/responsive/tai-xuong-xs.png 300w, https://ddtrungit.github.io/media/posts/80/responsive/tai-xuong-sm.png 480w, https://ddtrungit.github.io/media/posts/80/responsive/tai-xuong-md.png 768w, https://ddtrungit.github.io/media/posts/80/responsive/tai-xuong-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="157" width="320" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://ddtrungit.github.io/tags/zimbra/index.html">Zimbra</a></div><h3 class="c-card__title"><a href="https://ddtrungit.github.io/cac-buoc-rebuild-zimbra-server-ng-backup/index.html" class="invert">Các bước rebuild Zimbra server (NG Backup)</a></h3></header></div></article><article class="c-card"><a href="https://ddtrungit.github.io/csf-and-zimbra-mail/index.html" class="c-card__image"><img src="https://ddtrungit.github.io/media/posts/74/tai-xuong.png" srcset="https://ddtrungit.github.io/media/posts/74/responsive/tai-xuong-xs.png 300w, https://ddtrungit.github.io/media/posts/74/responsive/tai-xuong-sm.png 480w, https://ddtrungit.github.io/media/posts/74/responsive/tai-xuong-md.png 768w, https://ddtrungit.github.io/media/posts/74/responsive/tai-xuong-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="157" width="320" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://ddtrungit.github.io/tags/zimbra/index.html">Zimbra</a></div><h3 class="c-card__title"><a href="https://ddtrungit.github.io/csf-and-zimbra-mail/index.html" class="invert">Csf and Zimbra mail</a></h3></header></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="https://facebook.com/duongtrung2103" aria-label="Facebook" class="facebook"><svg><use xlink:href="https://ddtrungit.github.io/assets/svg/svg-map.svg#facebook"/></svg></a></div><div class="footer__copyright">"DO THE THINGS YOU LOVE!"</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://ddtrungit.github.io/assets/js/scripts.min.js?v=d78591855e0ce96bf51239b499260e20"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>