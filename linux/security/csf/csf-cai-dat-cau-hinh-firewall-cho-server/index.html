<!DOCTYPE html>
<!--[if IE 9 ]>
<html class="ie9" lang="vi"> <![endif]--><!--[if (gt IE 9)|!(IE)]><!--><html lang="vi">
<!--<![endif]-->

<head>
	<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="template" content="Tracks 1.76">

	<!-- This site is optimized with the Yoast SEO plugin v18.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>CSF cài đặt cấu hình firewall cho server -</title>
	<link rel="canonical" href="https://ddtrungit.github.io/linux/security/csf/csf-cai-dat-cau-hinh-firewall-cho-server/">
	<meta property="og:locale" content="vi_VN">
	<meta property="og:type" content="article">
	<meta property="og:title" content="CSF cài đặt cấu hình firewall cho server -">
	<meta property="og:description" content="CSF và lfd có chức năng firewall làm việc cùng iptables để bảo mật, giám&#8230;">
	<meta property="og:url" content="https://ddtrungit.github.io/linux/security/csf/csf-cai-dat-cau-hinh-firewall-cho-server/">
	<meta property="article:published_time" content="2021-01-27T08:03:28+00:00">
	<meta property="article:modified_time" content="2021-01-27T08:04:35+00:00">
	<meta property="og:image" content="https://ddtrungit.github.io/wp-content/uploads/2021/01/csf-la-gi.jpg">
	<meta property="og:image:width" content="675">
	<meta property="og:image:height" content="296">
	<meta property="og:image:type" content="image/jpeg">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:label1" content="Được viết bởi">
	<meta name="twitter:data1" content="admin">
	<meta name="twitter:label2" content="Ước tính thời gian đọc">
	<meta name="twitter:data2" content="12 phút">
	<script type="application/ld+json" class="yoast-schema-graph">{
	    "@context": "https://schema.org",
	    "@graph": [
	        {
	            "@type": "WebSite",
	            "@id": "https://ddtrungit.github.io/#website",
	            "url": "https://ddtrungit.github.io/",
	            "name": "",
	            "description": "DUONG TRUNG",
	            "potentialAction": [
	                {
	                    "@type": "SearchAction",
	                    "target": {
	                        "@type": "EntryPoint",
	                        "urlTemplate": "https://ddtrungit.github.io/?s={search_term_string}"
	                    },
	                    "query-input": "required name=search_term_string"
	                }
	            ],
	            "inLanguage": "vi"
	        },
	        {
	            "@type": "ImageObject",
	            "@id": "https://ddtrungit.github.io/linux/security/csf/csf-cai-dat-cau-hinh-firewall-cho-server/#primaryimage",
	            "inLanguage": "vi",
	            "url": "https://ddtrungit.github.io/wp-content/uploads/2021/01/csf-la-gi.jpg",
	            "contentUrl": "https://ddtrungit.github.io/wp-content/uploads/2021/01/csf-la-gi.jpg",
	            "width": 675,
	            "height": 296
	        },
	        {
	            "@type": "WebPage",
	            "@id": "https://ddtrungit.github.io/linux/security/csf/csf-cai-dat-cau-hinh-firewall-cho-server/#webpage",
	            "url": "https://ddtrungit.github.io/linux/security/csf/csf-cai-dat-cau-hinh-firewall-cho-server/",
	            "name": "CSF cài đặt cấu hình firewall cho server -",
	            "isPartOf": {
	                "@id": "https://ddtrungit.github.io/#website"
	            },
	            "primaryImageOfPage": {
	                "@id": "https://ddtrungit.github.io/linux/security/csf/csf-cai-dat-cau-hinh-firewall-cho-server/#primaryimage"
	            },
	            "datePublished": "2021-01-27T08:03:28+00:00",
	            "dateModified": "2021-01-27T08:04:35+00:00",
	            "author": {
	                "@id": "https://ddtrungit.github.io/#/schema/person/2ef6acb8c14b3bb1ab9466c551d93e1e"
	            },
	            "breadcrumb": {
	                "@id": "https://ddtrungit.github.io/linux/security/csf/csf-cai-dat-cau-hinh-firewall-cho-server/#breadcrumb"
	            },
	            "inLanguage": "vi",
	            "potentialAction": [
	                {
	                    "@type": "ReadAction",
	                    "target": [
	                        "https://ddtrungit.github.io/linux/security/csf/csf-cai-dat-cau-hinh-firewall-cho-server/"
	                    ]
	                }
	            ]
	        },
	        {
	            "@type": "BreadcrumbList",
	            "@id": "https://ddtrungit.github.io/linux/security/csf/csf-cai-dat-cau-hinh-firewall-cho-server/#breadcrumb",
	            "itemListElement": [
	                {
	                    "@type": "ListItem",
	                    "position": 1,
	                    "name": "Home",
	                    "item": "https://ddtrungit.github.io/"
	                },
	                {
	                    "@type": "ListItem",
	                    "position": 2,
	                    "name": "Blog",
	                    "item": "https://ddtrungit.github.io/blog/"
	                },
	                {
	                    "@type": "ListItem",
	                    "position": 3,
	                    "name": "CSF cài đặt cấu hình firewall cho server"
	                }
	            ]
	        },
	        {
	            "@type": "Person",
	            "@id": "https://ddtrungit.github.io/#/schema/person/2ef6acb8c14b3bb1ab9466c551d93e1e",
	            "name": "admin",
	            "url": "https://ddtrungit.github.io/author/admin/"
	        }
	    ]
	}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="Dòng thông tin  &raquo;" href="https://ddtrungit.github.io/feed/">
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/localhost\/wp\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.9.3"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style>
	<link rel="stylesheet" id="wp-block-library-css" href="https://ddtrungit.github.io/wp-includes/css/dist/block-library/style.min.css?ver=5.9.3" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 21px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--regular: 16px;--wp--preset--font-size--larger: 30px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}</style>
<link rel="stylesheet" id="rbuilder-styling-css" href="https://ddtrungit.github.io/wp-content/plugins/resume-builder/dist/main.css?ver=3.1.1" type="text/css" media="all">
<link rel="stylesheet" id="junkie-shortcodes-css" href="https://ddtrungit.github.io/wp-content/plugins/theme-junkie-shortcodes/assets/css/junkie-shortcodes.css?ver=5.9.3" type="text/css" media="all">
<link rel="stylesheet" id="ct-tracks-google-fonts-css" href="//fonts.googleapis.com/css?family=Raleway%3A400%2C700&#038;subset=latin%2Clatin-ext&#038;display=swap&#038;ver=5.9.3" type="text/css" media="all">
<link rel="stylesheet" id="ct-tracks-font-awesome-css" href="https://ddtrungit.github.io/wp-content/themes/tracks/assets/font-awesome/css/all.min.css?ver=5.9.3" type="text/css" media="all">
<link rel="stylesheet" id="ct-tracks-style-css" href="https://ddtrungit.github.io/wp-content/themes/tracks/style.css?ver=5.9.3" type="text/css" media="all">
<script type="text/javascript" src="https://ddtrungit.github.io/wp-includes/js/jquery/jquery.min.js?ver=3.6.0" id="jquery-core-js"></script>
<script type="text/javascript" src="https://ddtrungit.github.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://ddtrungit.github.io/wp-json/">
<link rel="alternate" type="application/json" href="https://ddtrungit.github.io/wp-json/wp/v2/posts/159">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://ddtrungit.github.io/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://ddtrungit.github.io/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.9.3">
<link rel="shortlink" href="https://ddtrungit.github.io/?p=159">
<link rel="alternate" type="application/json+oembed" href="https://ddtrungit.github.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fddtrungit.github.io%2Flinux%2Fsecurity%2Fcsf%2Fcsf-cai-dat-cau-hinh-firewall-cho-server%2F">
<link rel="alternate" type="text/xml+oembed" href="https://ddtrungit.github.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fddtrungit.github.io%2Flinux%2Fsecurity%2Fcsf%2Fcsf-cai-dat-cau-hinh-firewall-cho-server%2F&#038;format=xml">
            <link rel="alternate" media="only screen and (max-width: 640px)" href="https://ddtrungit.github.io/#article/159">
<link rel="icon" href="https://ddtrungit.github.io/wp-content/uploads/2021/01/cropped-2019-09-16-32x32.png" sizes="32x32">
<link rel="icon" href="https://ddtrungit.github.io/wp-content/uploads/2021/01/cropped-2019-09-16-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://ddtrungit.github.io/wp-content/uploads/2021/01/cropped-2019-09-16-180x180.png">
<meta name="msapplication-TileImage" content="https://ddtrungit.github.io/wp-content/uploads/2021/01/cropped-2019-09-16-270x270.png">
</head>

<body id="tracks" class="post-template-default single single-post postid-159 single-format-standard ct-body fpt-template-tracks singular singular-post singular-post-159 not-front standard">
		<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0.49803921568627"></fefuncr><fefuncg type="table" tablevalues="0 0.49803921568627"></fefuncg><fefuncb type="table" tablevalues="0 0.49803921568627"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.54901960784314 0.98823529411765"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.71764705882353 0.25490196078431"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 0.27843137254902"></fefuncg><fefuncb type="table" tablevalues="0.5921568627451 0.27843137254902"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0"></fefuncr><fefuncg type="table" tablevalues="0 0.64705882352941"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.78039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.94901960784314"></fefuncg><fefuncb type="table" tablevalues="0.35294117647059 0.47058823529412"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.65098039215686 0.40392156862745"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.44705882352941 0.4"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.098039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.66274509803922"></fefuncg><fefuncb type="table" tablevalues="0.84705882352941 0.41960784313725"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg>	<div id="overflow-container" class="overflow-container">
		<a class="skip-content" href="#main">Skip to content</a>
				<header id="site-header" class="site-header" role="banner">
									<div class="container">
				<div id="title-info" class="title-info">
					<div id="site-title" class="site-title"><a href="https://ddtrungit.github.io"><span class="screen-reader-text"></span><img class="logo" src="https://ddtrungit.github.io/wp-content/uploads/2022/06/Background_2.png" alt=""></a></div>				</div>
				<button id="toggle-navigation" class="toggle-navigation">
	<i class="fas fa-bars"></i>
</button>

<div id="menu-primary-tracks" class="menu-primary-tracks"></div>
<div id="menu-primary" class="menu-container menu-primary" role="navigation">

			<p class="site-description tagline">
			DUONG TRUNG		</p>
	<div class="menu"><ul id="menu-primary-items" class="menu-primary-items">
<li id="menu-item-20" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20"><a href="https://dtrungit.ga/">Trang chủ</a></li>
<li id="menu-item-67" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-has-children menu-item-67">
<a href="https://ddtrungit.github.io/blog/">Blog ></a>
<ul class="sub-menu">
	<li id="menu-item-71" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-71">
<a href="https://ddtrungit.github.io/oracle/">Oracle ></a>
	<ul class="sub-menu">
		<li id="menu-item-72" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-72"><a href="https://ddtrungit.github.io/oracle/rman/">Rman</a></li>
		<li id="menu-item-89" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89"><a href="https://ddtrungit.github.io/oracle/errore-oracle/">Errore Oracle</a></li>
	</ul>
</li>
	<li id="menu-item-73" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-73"><a href="https://ddtrungit.github.io/vsphere/">vSphere</a></li>
	<li id="menu-item-74" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-74"><a href="https://ddtrungit.github.io/windows/">Windows</a></li>
	<li id="menu-item-70" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-70">
<a href="https://ddtrungit.github.io/linux/">Linux ></a>
	<ul class="sub-menu">
		<li id="menu-item-458" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-458"><a href="https://ddtrungit.github.io/linux/ansible/">Ansible</a></li>
		<li id="menu-item-76" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-76">
<a href="https://ddtrungit.github.io/linux/security/">Security ></a>
		<ul class="sub-menu">
			<li id="menu-item-383" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-383"><a href="https://ddtrungit.github.io/linux/security/csf/">CSF Firewall</a></li>
		</ul>
</li>
		<li id="menu-item-382" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-382"><a href="https://ddtrungit.github.io/linux/zabbix/">Zabbix</a></li>
		<li id="menu-item-183" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-183"><a href="https://ddtrungit.github.io/linux/zimbra/">Zimbra</a></li>
	</ul>
</li>
	<li id="menu-item-68" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-68">
<a href="https://ddtrungit.github.io/aws/">AWS ></a>
	<ul class="sub-menu">
		<li id="menu-item-444" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-444"><a href="https://ddtrungit.github.io/aws/infra-project/">Infra Project</a></li>
	</ul>
</li>
	<li id="menu-item-69" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-69"><a href="https://ddtrungit.github.io/ccna/">CCNA</a></li>
</ul>
</li>
<li id="menu-item-387" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-387">
<a href="https://ddtrungit.github.io/cluster/">Cluster ></a>
<ul class="sub-menu">
	<li id="menu-item-388" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-388"><a href="https://ddtrungit.github.io/cluster/mysql/">Mysql</a></li>
</ul>
</li>
<li id="menu-item-167" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-167"><a href="https://ddtrungit.github.io/tip/">TIP</a></li>
<li id="menu-item-21" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21"><a href="https://ddtrungit.github.io/gioi-thieu/">Giới thiệu</a></li>
<li id="menu-item-291" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-291"><a href="https://ddtrungit.github.io/contact/">LIÊN HỆ</a></li>
<li id="menu-item-439" class="menu-item menu-item-type-post_type menu-item-object-rb_resume menu-item-439"><a href="https://ddtrungit.github.io/resume/d%c6%b0%c6%a1ng-%c4%91%c3%acnh-trung/">My CV</a></li>
</ul></div>
</div>			</div>
		</header>
						<div id="main" class="main" role="main">
			

	<div id="loop-container" class="loop-container">
		<div class="post-159 post type-post status-publish format-standard has-post-thumbnail hentry category-csf tag-slide1 tag-slide2 entry full-without-featured odd excerpt-1">
	<div class="featured-image" style="background-image: url(https://ddtrungit.github.io/wp-content/uploads/2021/01/csf-la-gi.jpg)"></div>	<div class="entry-meta">
			<span class="date">27 Tháng Một, 2021</span>	<span> / </span>	<span class="author"><a href="https://ddtrungit.github.io/author/admin/" title="Đăng bởi admin" rel="author">admin</a></span>	<span> / </span>	<span class="category">
	<a href="https://ddtrungit.github.io/linux/security/csf/">CSF</a>	</span>	</div>
	<div class="entry-header">
		<h1 class="entry-title">CSF cài đặt cấu hình firewall cho server</h1>
	</div>
	<div class="entry-container">
		<div class="entry-content">
			<article>
								
<p class="has-drop-cap">CSF và lfd có chức năng firewall làm việc cùng iptables để bảo mật, giám sát hệ thống, ngăn chặn truy cập trái phép, chống lại DOSS, brutefore …</p>



<p>ConfigServer Firewall (csf)</p>



<p>CSF&nbsp;là một firewall, nó giám sát trạng thái các kết nối đang hoạt động, nó sử dụng trạng thái giám sát được đẻ quyết định cho phép các gói tin đi qua firewall hay không.&nbsp;CSF&nbsp;cũng giám sát việc xác thực Login trên hệ thống (ví dụ login ftp 3 lần sai sẽ bí block IP), cũng như bảo mật các ứng dụng trên Server Linux</p>



<p>Cài đặt CSF (CentOS / RHEL)</p>



<p># yum install wget bind-utils -y&nbsp; &amp; update -y<br># yum install perl-libwww-perl net-tools perl-LWP-Protocol-https -y</p>



<p># yum install perl-libwww-perl<br># apt install libwww-perl</p>



<p># cd scr_csf &amp; mkdir scr_csf<br># wget <a href="https://download.configserver.com/csf.tgz">https://download.configserver.com/csf.tgz</a><br># tar -xzf csf.tgz<br># cd csf<br># sh install.sh</p>



<p>Sau khi cài xong, cần kiểm tra server đã có đủ các module để CSF làm việc không bằng lệnh:&nbsp;</p>



<p># perl /usr/local/csf/bin/csftest.pl</p>



<p>Nếu không có báo lỗi nào thì đã thành công. Trên CentOS 7 có thể tắt firewall mặc định&nbsp;firewalld</p>



<p># systemctl stop firewalld</p>



<p>#Thậm chí tắt hẳn chế độ chạy tự động<br># systemctl disable firewalld</p>



<p>Nếu muốn gỡ bỏ CSF thì dùng lệnh:</p>



<p># sh /etc/csf/uninstall.sh</p>



<p>Cấu hình và sử dụng</p>



<p>Cấu hình chính lưu tại&nbsp;/etc/csf/csf.conf</p>



<p>Đầu tiên mở&nbsp;csf.conf&nbsp;tìm và thiết lập cấu hình TEST</p>



<p># vi /etc/csf/csf.conf<br>TESTING = &#8220;1&#8221;<br>RESTRICT_SYSLOG = &#8220;3&#8221;</p>



<p>Nạp lại CSF</p>



<p># csf -r</p>



<ul>
<li>csf.conf : File cấu hình chính để quản lý CSF.</li>
<li>csf.allow : Danh sách địa chỉ IP cho phép qua firewall.</li>
<li>csf.deny : Danh sách địa chỉ IP từ chối qua&nbsp;firewall.</li>
<li>csf.ignore : Danh sách địa chỉ IP cho phép&nbsp;qua&nbsp;firewall và không bị block nếu có vấn đề.</li>
<li>csf.*ignore : Danh sách user, IP được ignore</li>
</ul>



<figure class="wp-block-table"><table><tbody>
<tr>
<td><strong>Lệnh</strong></td>
<td><strong>Tác dụng</strong></td>
</tr>
<tr>
<td>csf -h</td>
<td>Trợ giúp lệnh</td>
</tr>
<tr>
<td>csf -s</td>
<td>Chạy firewall</td>
</tr>
<tr>
<td>csf -f</td>
<td>Dừng &#8211; Flush firewall</td>
</tr>
<tr>
<td>csf -r</td>
<td>Nạp lại CSF (nhất là sau khi thay đổi cấu hình, thiết lập)</td>
</tr>
<tr>
<td>csf -l</td>
<td>Hiện thị các luật iptables (IP4)</td>
</tr>
<tr>
<td>csf -p</td>
<td>Kiểm tra các port đang mở</td>
</tr>
<tr>
<td>csf &#8211;lfd</td>
<td>với tham số [stop|start|restart|status] để điều khiện, chạy, dừng dịch vụ lfd. Dịch vụ này giám sát quá trình đăng nhập (kiểm tra xem nó có đang hoạt động&nbsp;csf &#8211;lfd status)</td>
</tr>
<tr>
<td>csf &#8211;lfd</td>
<td>với tham số [stop|start|restart|status] để điều khiện, chạy, dừng dịch vụ lfd. Dịch vụ này giám sát quá trình đăng nhập (kiểm tra xem nó có đang hoạt động&nbsp;csf &#8211;lfd status)</td>
</tr>
<tr>
<td>csf -a</td>
<td>Cho phép một IP truy cập, nó thêm vào danh sách&nbsp;/etc/csf/csf.allow, các IP liệt kê trong danh sách này mặc định được qua Firewall, tuy nhiên nó vẫn bị&nbsp;LFD&nbsp;kiểm tra. Ví dụ thêm IP 123.123.123.123 vào thì gõ&nbsp;<strong>csf -a 123.123.123.123</strong>
</td>
</tr>
<tr>
<td>csf -d</td>
<td>Cấm một IP truy cập, nó thêm vào danh sách&nbsp;/etc/csf/csf.deny, ví dụ&nbsp;<strong>csf -d 123.123.123.123</strong>
</td>
</tr>
<tr>
<td>csf -df</td>
<td>Gỡ một IP ra khỏi danh sách chặn&nbsp;<strong>csf -df 123.123.123.123</strong>
</td>
</tr>
<tr>
<td>csf -t</td>
<td>hiện thị danh sách ip cho phép và bị chặn tạm thời (ip tự ra khỏi danh sách sau một khoảng thời gian)</td>
</tr>
<tr>
<td>csf -x</td>
<td>Tắt hoàn toàn csf và lfd</td>
</tr>
<tr>
<td>csf -e</td>
<td>Kích hoạt lại csf và lfd</td>
</tr>
</tbody></table></figure>



<p>Một số thiết lập CSF, LFD</p>



<p>Nói chung tất cả cấu hình CSF, các luật firewall đều thiết lập, chỉnh sửa từ các file trong thư mục:&nbsp;<strong>/etc/csf</strong>. Sau khi chỉnh các thiết lập trong những file này cần khởi động lại để có hiệu lực bằng lệnh</p>



<p># csf -r &amp;&amp; csf &#8211;lfd restart</p>



<p>Nếu chưa có&nbsp;nano&nbsp;thì có thể cài vào để mở sửa các file config cho tiện</p>



<p># yum install nano -y</p>



<p>Mở file config ra để sửa đổi một số tính năng dưới</p>



<p># nano /etc/csf/csf.conf</p>



<p>1) Bảo vệ khỏi tấn công DOS bằng cách giới hạn số lượng truy cập tới cổng</p>



<p>Cấu hinh tại&nbsp;CONNLIMIT=&#8221;&#8221;&nbsp;với giá trị gán là&nbsp;&#8220;port1;limit1,port2,limit2 &#8230;&#8221;</p>



<p>Ví dụ:</p>



<p>CONNLIMIT = &#8220;22;5,80;20&#8221;</p>



<p>Có nghĩa là cổng 80 (http) cho phép 20 kết nối với 1 IP =&gt; Như vậy từ một máy tạo ra truy vấn liên tục tới server tạo ra quá 20 kết nối sẽ bị block, cổng 22 (ssh) là 5 kết nối 1 IP</p>



<p>Có thể đặt</p>



<p>CONNLIMIT = &#8220;80;200,443;200&#8221;</p>



<p>2) Phòng chống&nbsp;Port&nbsp;Flood</p>



<p>Giám sát tổng số lượng kết nối từ một IP tới một cổng trong một khoảng thời gian chỉ ra với thiết lập&nbsp;PORTFLOOD. Giá trị gán vào có dạng</p>



<p>PORTFLOOD = &#8220;cổng;giao thức;tổng kết nối;khoảng thời gian, &#8230;&#8221;</p>



<p>Ví dụ:</p>



<p>&nbsp;PORTFLOOD = &#8220;80;tcp;100;5&#8221;</p>



<p>Có nghĩa là 1 IP nào đó kết nối tới cổng 80 bằng giao thức tcp, trong vòng 5s mà tạo ra tới 100 kết nối thì bị block</p>



<p>3) Phòng chống&nbsp;SYN FLOOD</p>



<p>SYNFLOOD = &#8220;1&#8221;<br>SYNFLOOD_RATE = &#8220;75/s&#8221;<br>SYNFLOOD_BURST = &#8220;25&#8221;</p>



<p>Trong đó&nbsp;SYNFLOOD = &#8220;1&#8221;&nbsp;để kích hoạt SYN FLOOD.&nbsp;SYNFLOOD_RATE&nbsp;thiết lập số gói SYN gửi tới từ 1 IP /1s. Số lần mà một IP có thể chạm tới&nbsp;SYNFLOOD_RATE&nbsp;trước khi bị block.</p>



<p>4) Mở cổng, đóng cổng</p>



<p>#Các công mở cho phép nhận gói tin từ bên ngoài (IP4)<br>TCP_IN = &#8220;20,21,22,25,53,80&#8221;<br>#Các công mở cho phép gửi gói tin ra ngoài (IP4)<br>TCP_OUT = &#8220;443,20,21,22,25,80&#8221;<br>#Tương tự nếu có dùng IP6<br>TCP6_IN = &#8220;20,21,22,25&#8221;<br>TCP6_OUT = &#8220;20,21,22,25&#8221;</p>



<p>* Các cổng mà các dịch vụ trên server sử dụng:</p>



<ul>
<li>Port 20: FTP data transfer</li>
<li>Port 21: FTP</li>
<li>Port 22: SSH</li>
<li>Port 25: SMTP</li>
<li>Port 53: DNS</li>
<li>Port 80: HTTP</li>
<li>Port 110: POP3</li>
<li>Port 113: Authentication service/identification protocol</li>
<li>Port 143: IMAP</li>
<li>Port 443: SSL/TLS (HTTPS)</li>
</ul>



<p>5) Server quá tải ?</p>



<p>CSF mặc định có kiểm tra mức độ hoạt động của CPU xem nó có bị quá tải hay không. Nếu có sự kiện đó xảy ra thì một email sẽ được gửi đi, trong nhiều trường hợp quá tải dẫn tới Server bị treo. Bạn có thể thiết lập khi quá tải CPU như vậy sẽ chạy script bạn tạo ra để làm một số việc bạn thiết lập ví dụ như khởi động lại Apache</p>



<p>Giả sử bạn tạo ra một script để khởi động lại Apache, lưu tại&nbsp;/restartapache.sh, nhớ chmod cho nó chạy được&nbsp;chmod +x /restartapache.sh</p>



<p>Nội dung của script đó chỉ là lệnh khởi động lại Apache</p>



<p>#!/bin/sh<br>service httpd restart &gt;&gt; overload.log</p>



<p>Bây giờ muốn mỗi khi CPU quá tải sẽ chạy script&nbsp;/restartapache.sh&nbsp;thì sửa config:</p>



<p>#!/bin/sh<br>PT_LOAD_ACTION=&#8221;/restartapache.sh&#8221;</p>



<p>6) Cấm tất cả các IP đến từ một quốc gia nào đó</p>



<p>Tìm đến dòng&nbsp;CC_DENY và điền mã quốc gia cần cấm. Ví dụ chặn IP đến từ Nga và TQ</p>



<p>CC_DENY = &#8220;RU,CN&#8221;</p>



<p>7)Email thông báo</p>



<p>Các sự kiện do CSF xử lý, bắt được sẽ được gửi tới một email</p>



<p>LF_ALERT_TO = &#8220;server@yourdomain.com&#8221;</p>



<p>LF_SSH_EMAIL_ALERT = &#8220;0&#8221;</p>



<p>LF_EMAIL_ALERT = 0</p>



<p>&nbsp;LF_TEMP_EMAIL_ALERT = &#8220;0&#8221;</p>



<p>Không gửi email thông báo khi có một ai đó login thành công thông qua SSH</p>



<p>8) Block nếu đăng nhập các dịch vụ thất bại</p>



<p>#KÍCH HOẠT GIÁM SÁT LOGIN<br>LF_TRIGGER = &#8220;1&#8221;</p>



<p>#Block nếu đăng nhập ssh sai 3 lần<br>LF_SSHD = &#8220;3&#8221;<br>LF_SSHD_PERM = &#8220;1&#8221;</p>



<p>#Block nếu đăng nhập ftp sai 3 lần<br>LF_FTPD = &#8220;3&#8221;<br>LF_FTPD_PERM = &#8220;1&#8221;</p>



<p>Còn một số dịch vụ nữa xem thêm ngay sau các thiết lập này</p>



<p>9) Block danh sách IP SPAM</p>



<p>CSF cung cấp khóa cả danh sách IP, bằng cách đưa URL của danh sách đó vào file&nbsp;/etc/csf/csf.blocklists. Bạn có thể mở file đó ra thêm các danh sách IP mà các dịch vụ phát hiện IP SPAM sau cung cấp:</p>



<p># Spamhaus Don&#8217;t Route Or Peer List (DROP)<br># Details: <a href="http://www.spamhaus.org/drop/">http://www.spamhaus.org/drop/</a><br>SPAMDROP|86400|0|http://www.spamhaus.org/drop/drop.lasso</p>



<p># Spamhaus Extended DROP List (EDROP)<br># Details: <a href="http://www.spamhaus.org/drop/">http://www.spamhaus.org/drop/</a><br>SPAMEDROP|86400|0|http://www.spamhaus.org/drop/edrop.lasso</p>



<p># DShield.org Recommended Block List<br># Details: <a href="http://dshield.org/">http://dshield.org</a><br>DSHIELD|86400|0|http://www.dshield.org/block.txt</p>



<p># TOR Exit Nodes List<br># Set URLGET in csf.conf to use LWP as this list uses an SSL connection<br># Details: <a href="https://trac.torproject.org/projects/tor/wiki/doc/TorDNSExitList">https://trac.torproject.org/projects/tor/wiki/doc/TorDNSExitList</a><br>TOR|3600|0|https://check.torproject.org/cgi-bin/TorBulkExitList.py?ip=1.2.3.4</p>



<p># Alternative TOR Exit Nodes List<br># Details: <a href="http://torstatus.blutmagie.de/">http://torstatus.blutmagie.de/</a><br>ALTTOR|86400|0|http://torstatus.blutmagie.de/ip_list_exit.php/Tor_ip_list_EXIT.csv</p>



<p># BOGON list<br># Details: <a href="http://www.team-cymru.org/Services/Bogons/">http://www.team-cymru.org/Services/Bogons/</a><br>BOGON|86400|0|http://www.cymru.com/Documents/bogon-bn-agg.txt</p>



<p># Project Honey Pot Directory of Dictionary Attacker IPs<br># Details: <a href="http://www.projecthoneypot.org/">http://www.projecthoneypot.org</a><br>HONEYPOT|86400|0|http://www.projecthoneypot.org/list_of_ips.php?t=d&amp;rss=1</p>



<p># C.I. Army Malicious IP List<br># Details: <a href="http://www.ciarmy.com/">http://www.ciarmy.com</a><br>CIARMY|86400|0|http://www.ciarmy.com/list/ci-badguys.txt</p>



<p># BruteForceBlocker IP List<br># Details: <a href="http://danger.rulez.sk/index.php/bruteforceblocker/">http://danger.rulez.sk/index.php/bruteforceblocker/</a><br>BFB|86400|0|http://danger.rulez.sk/projects/bruteforceblocker/blist.php</p>



<p># OpenBL.org 30 day List<br># Set URLGET in csf.conf to use LWP as this list uses an SSL connection<br># Details: <a href="https://www.openbl.org/">https://www.openbl.org</a><br>OPENBL|86400|0|https://www.openbl.org/lists/base_30days.txt</p>



<p># Autoshun Shun List<br># Details: <a href="http://www.autoshun.org/">http://www.autoshun.org/</a><br>AUTOSHUN|86400|0|http://www.autoshun.org/files/shunlist.csv</p>



<p># MaxMind GeoIP Anonymous Proxies<br># Set URLGET in csf.conf to use LWP as this list uses an SSL connection<br># Details: <a href="https://www.maxmind.com/en/anonymous_proxies">https://www.maxmind.com/en/anonymous_proxies</a><br>MAXMIND|86400|0|https://www.maxmind.com/en/anonymous_proxies</p>



<p># Blocklist.de<br># Set URLGET in csf.conf to use LWP as this list uses an SSL connection<br># Details: <a href="https://www.blocklist.de/">https://www.blocklist.de</a><br># This first list only retrieves the IP addresses added in the last hour<br>#BDE|3600|0|https://api.blocklist.de/getlast.php?time=3600<br># This second list retrieves all the IP addresses added in the last 48 hours<br># and is usually a very large list (over 10000 entries), so be sure that you<br># have the resources available to use it<br>BDEALL|86400|0|http://lists.blocklist.de/lists/all.txt</p>



<p># Stop Forum Spam<br># Details: <a href="http://www.stopforumspam.com/downloads/">http://www.stopforumspam.com/downloads/</a><br># Many of the lists available contain a vast number of IP addresses so special<br># care needs to be made when selecting from their lists<br>STOPFORUMSPAM|86400|0|http://www.stopforumspam.com/downloads/listed_ip_1.zip</p>



<p>######################################################</p>



<p>Hướng dẫn cấu hình CSF (ConfigServer &amp; Firewall)</p>



<p>&#8211; File cấu hình nằm ở /etc/csf/csf.conf , các file còn lại được nhắc đến bên dưới nếu không nêu rõ đường dẫn thì đều nằm ở thư mục /etc/csf/</p>



<p>&#8211; Các tham số khi cấu hình có dạng ARGS = &#8220;VALUE&#8221; , trong đó</p>



<p>+ VALUE = &#8220;0&#8221; =&gt; Disable</p>



<p>+ VALUE = &#8220;1&#8221; =&gt; Enable</p>



<p>+ VALUE &gt; 1 (VALUE = &#8220;20&#8221; , VALUE = &#8220;30&#8221; &#8230; ) : giới hạn tối đa.</p>



<p>+ VALUE &gt;1 (VALUE = &#8220;1800&#8221; , VALUE = &#8220;3600&#8221; &#8230; ) : thời gian tối đa.</p>



<p>Bắt đầu:</p>



<p>TESTING = &#8220;0&#8221;</p>



<p>Mặc định khi vừa cài TESTING = &#8220;1&#8221;, với TESTING = &#8220;1&#8221; thì LFD daemon (Login Fail Detect daemon) sẽ không hoạt động, do đó nếu có gì sai sót thì server cũng sẽ không block IP của bạn. Khi cảm thấy cấu hình đã ổn thì tắt TESTING để LFD bắt đầu hoạt động và chặn các IP tấn công.</p>



<p>TESTING_INTERVAL = &#8220;5&#8221;</p>



<p>Thời gian chạy cronjob để clear iptables nếu như TESTING=1 , tính bằng phút.</p>



<p>AUTO_UPDATES = &#8220;0&#8221;</p>



<p>Disable auto update</p>



<p>TCP_IN = &#8220;22,25,53,80,443&#8221;</p>



<p>Allow incoming TCP ports: cho ngừoi dùng kết nối đến các dịch vụ SSH, sendmail, DNS, Web trên server.</p>



<p>TCP_OUT = &#8220;25,80&#8221;</p>



<p>Allow outgoing TCP port: cho phép server kết nối đến web server, sendmail server khác.</p>



<p>UDP_IN = &#8220;53&#8221;</p>



<p>Allow incoming UDP ports: cho phép người dùng sử dụng dịch vụ DNS trên server.</p>



<p>UDP_OUT = &#8220;53&#8221;</p>



<p>Allow outgoing UDP ports: cho phép server truy vấn DNS bên ngoài.</p>



<p>ICMP_IN = &#8220;1&#8221;</p>



<p>Cho phép ping đến server.</p>



<p>ICMP_IN_RATE = &#8220;1/s&#8221;</p>



<p>Giới hạn tần số ping đến server là 1/s. Nếu ping nhanh hơn tốc độ này sẽ nhận được &#8220;Request timeout&#8221; . Trong trường hợp nếu nhiều người cùng ping đến server cùng lúc , thì phần lớn sẽ nhận được các phản hồi &#8220;Request timeout&#8221; do server chỉ nhận 1 request/s , điều này làm chúng ta lầm tưởng kết nối mạng có vấn đề , mạng bị chập chờn nhưng thật ra không phải như vậy . Chỉ cần nâng thông số này lên cao một chút hoặc bỏ luôn ( set giá trị = 0 ) sẽ khắc phục được tình trạng trên.</p>



<p>ETH_DEVICE = &#8220;eth0&#8221;</p>



<p>Mặc định csf sẽ cấu hình iptables để filter traffic trên toàn bộ các card mạng , ngoại trừ card loopback . Nếu như bạn muốn rules iptables chỉ applied vào card mạng &#8220;eth0&#8221; thì khai báo ở đây.</p>



<p>ETH_DEVICE_SKIP = &#8220;eth1&#8221;</p>



<p>Nếu bạn không muốn rules iptables không applied vào card mạng nào thì khai báo ở đây. Ví dụ card &#8220;eth1&#8221; là card local , bạn không muốn filter trên card này thì cấu hình như trên.</p>



<p>DENY_IP_LIMIT = &#8220;500</p>



<p>&#8220;</p>



<p>Giới hạn số lượng IP bị block &#8220;vĩnh viễn&#8221; bởi CSF (các IP này được lưu trong file /etc/csf/csf.deny). Con số này tùy thuộc vào resource của mỗi server, nếu dùng VPS thì con số này vào khoảng &#8220;200&#8221; là hợp lý , còn dedicated server thì khoảng &#8220;500&#8221;. Khi số lượng IP bị block vượt qua con số này , csf sẽ tự động unblock IP cũ nhất (IP ở dòng 1 của file /etc/csf/csf.deny)</p>



<p>LF_DAEMON = &#8220;1&#8221;</p>



<p>Enable tính năng Login fail detection.</p>



<p>LF_CSF = &#8220;1&#8221;</p>



<p>Tự động restart CSF khi csf bị stop.</p>



<p>PACKET_FILTER = &#8220;1&#8221;</p>



<p>Filter các gói tin TCP không hợp lệ (INVALID state như : sequence number không đúng , kết nối ko được thực hiện đủ qua 3 bước bắt tay &#8230; )</p>



<p>IPV6 = &#8220;0&#8221;</p>



<p>Disable IPV6 support</p>



<p>SYNFLOOD = &#8220;1&#8221;SYNFLOOD_RATE = &#8220;30/s&#8221;SYNFLOOD_BURST = &#8220;40&#8221;</p>



<p>Enable synflood protection : Nếu 1 IP gửi 30 cú SYN trong vòng 1s và số lượng SYN connection tồn tại trên server đạt trên 40 thì block IP đó (temp block)</p>



<p>CONNLIMIT = &#8220;80;20&#8221;</p>



<p>Giới hạn số lượng new concurrent connection đến server trên mỗi IP. Ví dụ trên có nghĩa : mỗi IP được phép mở 20 concurrent new connection đến port 80 trên server.</p>



<p>PORTFLOOD = &#8220;80;tcp;20;5&#8221;</p>



<p>Giới hạn số lượng connection đến một port cụ thể trong một khoảng thời gian nhất định. Ví dụ như trên có nghĩa : nếu nhiều hơn 20 kết nối tcp đến port 80 trong vòng 5s thì block IP đó tối thiểu 5s tính từ packet cuối cùng của IP đó. Sau 5s IP đó sẽ tự động được unlock và truy cập bình thường.</p>



<p>DROP_NOLOG = &#8220;10050,10051&#8221;</p>



<p>Danh sách các port khi bị drop sẽ không cần phải ghi vào log</p>



<p>CONNLIMIT_LOGGING = &#8220;1&#8221;</p>



<p>Ghi log các IP vượt quá giới hạn CONNLIMIT cấu hình ở bước trên.</p>



<p>LF_ALERT_TO = &#8220;your_email@your_domain.com&#8221;</p>



<p>Mặc định toàn bộ email thông báo sẽ được gửi về root của server . Nếu bạn muốn gửi đến địa chỉ email khác thì khai báo ở đây.</p>



<p>LF_PERMBLOCK = &#8220;1&#8221;LF_PERMBLOCK_INTERVAL = &#8220;86400&#8221;LF_PERMBLOCK_COUNT = &#8220;6&#8221;LF_PERMBLOCK_ALERT = &#8220;1&#8221;</p>



<p>Enable tính năng block vĩnh viễn một IP . Nếu một IP bị temp ban (ban tạm) 6 lần khi vi phạm các rule sẽ block ip này 86400s ( 1 ngày) đồng thời gửi email về cho ngừoi quản trị biết.</p>



<p>LF_TRIGGER = &#8220;1&#8221;</p>



<p>Enable tính năng Login Fail Detect cho từng dịch vụ cụ thể (được khai báo bên dưới)</p>



<p>LF_TRIGGER_PERM = &#8220;1&#8221;</p>



<p>Khi LF_TRIGGER = &#8220;1&#8221; thì có thể enable LF_TRIGGER_PERM để kích hoạt block IP permanent</p>



<p>+ LF_TRIGGER_PERM = &#8220;1&#8221; =&gt; IP sẽ bị block permanent</p>



<p>+ LF_TRIGGER_PERM = &#8220;86400&#8221; =&gt; IP sẽ bị block 1 ngày</p>



<p>LF_SELECT = &#8220;1&#8221;</p>



<p>Khi một IP vi phạm các rule của LFD thay vì block toàn bộ traffic từ IP này đến server thì chỉ block traffic đến dịch vụ mà IP này login fail (ví dụ login ftp sai nhiều lần thì block truy cập đến FTP nhưng vẫn cho phép truy cập vào website)</p>



<p>LF_EMAIL_ALERT = &#8220;1&#8221;</p>



<p>Gửi email thông báo nếu một IP bị block bởi các trigger bên dưới</p>



<p>LF_SSHD = &#8220;5&#8221;LF_SSHD_PERM = &#8220;1&#8221;</p>



<p>Nếu login SSH sai 5 lần thì sẽ bị block IP (temp block)</p>



<p>Nếu bị temp block lớn hơn số lần quy định ở LF_PERMBLOCK_COUNT (cấu hình bước trên ) thì sẽ block permanent.</p>



<p>LF_FTPD = &#8220;0&#8221;LF_FTPD_PERM = &#8220;1&#8221;</p>



<p>Không kích hoạt login fail detect cho dịch vụ FTP.</p>



<p>Tương tự cho các dịch vụ còn lại bên dưới ( SMTP , POP3 , IMAP , .htpasswd , mod_security &#8230; )</p>



<p>LF_SSH_EMAIL_ALERT = &#8220;0&#8221;</p>



<p>LF_EMAIL_ALERT = 0</p>



<p>&nbsp;LF_TEMP_EMAIL_ALERT = &#8220;0&#8221;</p>



<p>Không gửi email thông báo khi có một ai đó login thành công thông qua SSH</p>



<p>LF_SU_EMAIL_ALERT = &#8220;0&#8221;</p>



<p>Không gửi email thông báo khi có một người dùng &#8220;su&#8221; (switch user) qua người dùng khác. Không gửi email khi họ dùng lệnh &#8220;su&#8221; , bất kể &#8220;su&#8221; thành công hoặc thất bại.</p>



<p>LF_DIRWATCH = &#8220;3600&#8221;</p>



<p class="has-drop-cap">LFD sẽ check thư mục /tmp và /dev/shm định kỳ sau mỗi 3600s , nếu phát hiện ra các file nghi vấn là file độc hại sẽ gửi email thông báo đến cho chúng ta. Thường thì trên server thư mục, /temp và /dev/shm phân quyền cho phép mọi người dùng có quyền ghi trên thư mục này , do đó các attacker lợi dụng điều này để ghi mã độc vào đây (các file để back connect , local root exploit &#8230; )</p>
							</article>
		</div>
				<div class="entry-meta-bottom">
			<nav class="further-reading">
	<p class="prev">
		<span>Previous Post</span>
		<a href="https://ddtrungit.github.io/linux/how-to-fix-centos-6-end-of-line-error-yumrepo-error-all-mirror-urls-are-not-using-ftp-https-or-file/">HOW TO FIX CENTOS 6 End of Line ERROR: YUMREPO ERROR: ALL MIRROR URLS ARE NOT USING FTP, HTTP[S] OR FILE</a>
	</p>
	<p class="next">
		<span>Next Post</span>
		<a href="https://ddtrungit.github.io/linux/security/csf/csf-and-zimbra-mail/">Csf and Zimbra mail</a>
	</p>
</nav>			<div class="entry-categories"><p><span>Categories</span><a href="https://ddtrungit.github.io/linux/security/csf/" title="View all posts in CSF">CSF</a></p></div>			<div class="entry-tags"><p><span>Tags</span><a href="https://ddtrungit.github.io/tag/slide1/" title="View all posts tagged slide1">slide1</a> <a href="https://ddtrungit.github.io/tag/slide2/" title="View all posts tagged slide2">slide2</a></p></div>		</div>
		<div class="author-meta">
	<div class="author">
				<span>
			Written by:<a href="https://ddtrungit.github.io/author/admin/" title="Đăng bởi admin" rel="author">admin</a>        </span>
	</div>
	<div class="bio">
		<p></p>
			</div>
</div>	</div>
</div>	</div>

</div> <!-- .main -->

<footer id="site-footer" class="site-footer" role="contentinfo">
	<div class="design-credit">
		<p>
			<a target="_blank" href="https://dtrungit.ga/" rel="nofollow">Edit By </a> by TrungDD.		</p>
	</div>
</footer>

	<button id="return-top" class="return-top">
		<i class="fas fa-arrow-up"></i>
	</button>

</div>
<!-- .overflow-container -->

<script type="text/javascript" src="https://ddtrungit.github.io/wp-includes/js/jquery/ui/core.min.js?ver=1.13.1" id="jquery-ui-core-js"></script>
<script type="text/javascript" src="https://ddtrungit.github.io/wp-includes/js/jquery/ui/accordion.min.js?ver=1.13.1" id="jquery-ui-accordion-js"></script>
<script type="text/javascript" src="https://ddtrungit.github.io/wp-includes/js/jquery/ui/tabs.min.js?ver=1.13.1" id="jquery-ui-tabs-js"></script>
<script type="text/javascript" src="https://ddtrungit.github.io/wp-content/plugins/theme-junkie-shortcodes/assets/js/junkie-shortcodes.js" id="junkie-shortcodes-js-js"></script>
<script type="text/javascript" src="https://ddtrungit.github.io/wp-content/themes/tracks/js/build/production.min.js?ver=5.9.3" id="ct-tracks-production-js"></script>
</body>
</html>