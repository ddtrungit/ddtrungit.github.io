<!DOCTYPE html><html lang="vi"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Sử dụng Ansible thông qua Bastion Host - TRUNG DUONG</title><meta name="robots" content="noindex,nofollow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#D73A42" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#D73A42"><meta name="apple-mobile-web-app-status-bar-style" content="#D73A42"><link rel="alternate" type="application/atom+xml" href="http://blog.dtrungit.ga/feed.xml"><link rel="alternate" type="application/json" href="http://blog.dtrungit.ga/feed.json"><link rel="shortcut icon" href="http://blog.dtrungit.ga/media/website/cropped-2019-09-16-32x32.png" type="image/x-icon"><link rel="shortcut icon" href="http://blog.dtrungit.ga/media/website/cropped-2019-09-16-32x32.png" type="image/x-icon"><link rel="stylesheet" href="http://blog.dtrungit.ga/assets/css/style.css?v=4becd99c93342dd7c117b97188f052e6"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.dtrungit.ga/su-dung-ansible-thong-qua-bastion-host/index.html"},"headline":"Sử dụng Ansible thông qua Bastion Host","datePublished":"2022-03-03T04:43","dateModified":"2022-06-13T14:24","image":{"@type":"ImageObject","url":"http://blog.dtrungit.ga/media/posts/110/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1.png","height":368,"width":1024},"description":"Bastion host là gì? Bastion dịch theo nghĩa đen là một nơi được tăng cường. Về thuật ngữ máy tính,&hellip;","author":{"@type":"Person","name":"Duong Dinh Trung","url":"http://blog.dtrungit.ga/authors/dtrungit/"},"publisher":{"@type":"Organization","name":"Duong Dinh Trung","logo":{"@type":"ImageObject","url":"http://blog.dtrungit.ga/media/website/Background_2.png","height":800,"width":834}}}</script></head><body><header class="header" id="js-header"><a href="http://blog.dtrungit.ga/index.html" class="logo"><img src="http://blog.dtrungit.ga/media/website/Background_2.png" alt="TRUNG DUONG"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="http://blog.dtrungit.ga/index.html" target="_self">Home</a></li><li><a href="http://blog.dtrungit.ga/lien-he/index.html" target="_self">Contact</a></li><li><a href="http://blog.dtrungit.ga/gioi-thieu/index.html" target="_self">About</a></li><li><a href="http://blog.dtrungit.ga/tags/aws/index.html" target="_self">AWS</a></li><li><a href="http://blog.dtrungit.ga/tags/oracle/index.html" target="_self">Oracle</a></li><li class="has-submenu"><a href="http://blog.dtrungit.ga/tags/linux/index.html" target="_self" aria-haspopup="true">Linux</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="http://blog.dtrungit.ga/tags/ansible/index.html" target="_self">Ansible</a></li><li><a href="http://blog.dtrungit.ga/tags/k8s/index.html" target="_self">Kubernetes</a></li><li><a href="http://blog.dtrungit.ga/tags/oracle/index.html" target="_self">Oracle</a></li><li><a href="http://blog.dtrungit.ga/tags/zimbra/index.html" target="_self">Zimbra</a></li><li><a href="http://blog.dtrungit.ga/tags/tip/index.html" target="_self">TIP</a></li></ul></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><h1 class="post__title">Sử dụng Ansible thông qua Bastion Host</h1><div class="post__meta"><div class="post__author">By <a href="http://blog.dtrungit.ga/authors/dtrungit/index.html" class="invert" rel="author" title="Duong Dinh Trung">Duong Dinh Trung</a></div><div class="post__comments"><a href="http://blog.dtrungit.ga/su-dung-ansible-thong-qua-bastion-host/index.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="http://blog.dtrungit.ga/assets/svg/svg-map.svg#comments"/></svg></a></div></div></header><figure class="post__featured-image"><img src="http://blog.dtrungit.ga/media/posts/110/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1.png" srcset="http://blog.dtrungit.ga/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-xs.png 300w, http://blog.dtrungit.ga/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-sm.png 480w, http://blog.dtrungit.ga/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-md.png 768w, http://blog.dtrungit.ga/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="368" width="1024" alt=""></figure><div class="post__inner"><div class="post__entry"><ul><li>Bastion host là gì?</li></ul><p style="text-align: left;">Bastion dịch theo nghĩa đen là một nơi được tăng cường. Về thuật ngữ máy tính, đó là một máy trên mạng có thể là gatekeeper cho các kết nối đến và đi. Wikipedia định nghĩa: Máy chủ pháo đài (bastion host) là một máy tính có mục đích đặc biệt trên mạng, được thiết kế và cấu hình riêng để chịu được các cuộc tấn công. Máy chủ pháo đài thường chỉ lưu trữ một ứng dụng duy nhất, ví dụ như máy chủ proxy, các dịch vụ khác sẽ bị xóa hoặc giới hạn để giảm thiểu mối đe dọa cho máy tính. Sở dĩ, bastion host được thiết lập cứng như vậy là do vị trí và mục đích đặc biệt của nó, thường được đặt bên ngoài tường lửa hoặc trong vùng DMZ (một vùng mạng trung lập giữa mạng nội bộ và mạng Internet) và thường liên quan đến những truy cập từ các mạng hoặc máy tính không đáng tin cậy. Bạn có thể thiết lập bastion host làm máy duy nhất chấp nhận kết nối từ Internet. Sau đó, lần lượt, thiết lập tất cả các máy khác trong mạng để chỉ nhận các kết nối đến từ máy bastion host này.</p><figure class="alignnone wp-image-504"><img loading="lazy" src="http://blog.dtrungit.ga/media/posts/110/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-300x108.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="http://blog.dtrungit.ga/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-300x108-xs.png 300w, http://blog.dtrungit.ga/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-300x108-sm.png 480w, http://blog.dtrungit.ga/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-300x108-md.png 768w" alt="" width="719" height="259"></figure><p>Khai báo các máy chủ vào :</p><blockquote><em>/etc/ansible/hosts</em></blockquote><p style="padding-left: 160px;"><em>[proxy]</em> <em>3.115.75.133</em></p><p style="padding-left: 160px;"><em>[web]</em> <em>10.1.0.48</em> <em>10.1.0.29</em></p><blockquote><em>/etc/ansible/ansible.cfg</em></blockquote><p style="padding-left: 40px;">[ssh_connection]</p><p style="padding-left: 40px;"><em>ssh_args = -F ~/.ssh/config -o ControlMaster=auto -o ControlPersist=30m -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -o ForwardAgent=yes</em> <em>control_path = ~/.ansible/cp/ansible-%%r@%%h:%%p</em></p><blockquote><em>/home/<strong>username</strong>/.ssh/config</em></blockquote><p style="padding-left: 160px;"><em>Host proxy</em> <em>Hostname 3.115.75.133</em> <em>IdentityFile ~/bastion_ssh_key</em> <em>User ec2-user</em></p><p style="padding-left: 160px;"><em>Host 3.115.75.130</em> <em>Hostname 3.115.75.133</em> <em>IdentityFile ~/bastion_ssh_key</em> <em>User ec2-user</em></p><p style="padding-left: 160px;"><em>Host api</em> <em>Hostname 10.1.0.48</em> <em>User ec2-user</em> <em>IdentityFile ~/web_ssh_key</em> <em>ProxyCommand ssh -W %h:%p proxy</em></p><p style="padding-left: 160px;"><em>Host admin</em> <em>Hostname 10.1.0.29</em> <em>User ec2-user</em> <em>IdentityFile ~/web_ssh_key</em> <em>ProxyCommand ssh -W %h:%p proxy</em> <em>Host 10.1.*</em> <em>User ec2-user</em> <em>IdentityFile ~/api_ssh_key</em> <em>ProxyCommand ssh -W %h:%p proxy</em></p><p>Như vậy khi chỉ định ansible group proxy hay web thì sẽ kết nối  ssh bình thường.</p></div><footer><div class="post__tags-share"><aside class="post__share"></aside></div><nav class="post__nav"><div class="post__nav__prev"><a class="post__nav__link" href="http://blog.dtrungit.ga/ansible-la-gi-huong-dan-cai-dat-ansible/index.html" rel="prev">Previous Post<h3 class="h6">Ansible Là Gì? Hướng Dẫn Cài Đặt Ansible</h3></a></div><div class="post__nav__next"><a class="post__nav__link" href="http://blog.dtrungit.ga/hieu-ro-ve-quyen-truy-cap-tep-trong-linux/index.html" rel="prev">Next Post<h3 class="h6">Hiểu rõ về quyền truy cập tệp trong linux</h3></a></div></nav></footer></div></article><div class="comments-area post__inner" id="comments"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div class="fb-comments" data-href="http://blog.dtrungit.ga/su-dung-ansible-thong-qua-bastion-host/" data-width="100%" data-colorscheme="light" data-lazy="true" data-order-by="reverse_time" data-numposts="5"></div><noscript>Please enable JS to use the comments form.</noscript></div></div><div id="fb-root"></div><script type="text/javascript" async defer="defer" crossorigin="anonymous" src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v12.0">nonce="n4mWU9e7"</script></div></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><a href="http://blog.dtrungit.ga/ansible-la-gi-huong-dan-cai-dat-ansible/index.html" class="c-card__image"><img src="http://blog.dtrungit.ga/media/posts/109/Ansible-la-gi-1.png" srcset="http://blog.dtrungit.ga/media/posts/109/responsive/Ansible-la-gi-1-xs.png 300w, http://blog.dtrungit.ga/media/posts/109/responsive/Ansible-la-gi-1-sm.png 480w, http://blog.dtrungit.ga/media/posts/109/responsive/Ansible-la-gi-1-md.png 768w, http://blog.dtrungit.ga/media/posts/109/responsive/Ansible-la-gi-1-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="358" width="750" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="http://blog.dtrungit.ga/tags/ansible/index.html">Ansible</a></div><h3 class="c-card__title"><a href="http://blog.dtrungit.ga/ansible-la-gi-huong-dan-cai-dat-ansible/index.html" class="invert">Ansible Là Gì? Hướng Dẫn Cài Đặt Ansible</a></h3></header><p class="c-card__text">Trong một môi trường với nhiều server thì ta sẽ có vô vàn thứ phải lo. Từ setup crontab, update&hellip;</p><footer class="c-card__meta"><div class="c-card__comments"><a href="http://blog.dtrungit.ga/ansible-la-gi-huong-dan-cai-dat-ansible/index.html#comments" rel="nofollow" aria-label="Comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="http://blog.dtrungit.ga/assets/svg/svg-map.svg#comments"/></svg></a></div></footer></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="https://facebook.com/duongtrung2103" aria-label="Facebook" class="facebook"><svg><use xlink:href="http://blog.dtrungit.ga/assets/svg/svg-map.svg#facebook"/></svg></a></div><div class="footer__copyright">"DO THE THINGS YOU LOVE!"</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="http://blog.dtrungit.ga/assets/js/scripts.min.js?v=d78591855e0ce96bf51239b499260e20"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>