<!DOCTYPE html><html lang="vi"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Sử dụng Ansible thông qua Bastion Host - TRUNG DUONG</title><meta name="robots" content="noindex,nofollow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="alternate" type="application/atom+xml" href="https://ddtrungit.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://ddtrungit.github.io/feed.json"><link rel="stylesheet" href="https://ddtrungit.github.io/assets/css/style.css?v=6ddec22a33b6e591633ba53617c15038"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://ddtrungit.github.io/su-dung-ansible-thong-qua-bastion-host/index.html"},"headline":"Sử dụng Ansible thông qua Bastion Host","datePublished":"2022-03-03T04:43","dateModified":"2022-06-13T14:24","image":{"@type":"ImageObject","url":"https://ddtrungit.github.io/media/posts/110/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1.png","height":368,"width":1024},"description":"Bastion host là gì? Bastion dịch theo nghĩa đen là một nơi được tăng cường. Về thuật ngữ máy tính,&hellip;","author":{"@type":"Person","name":"Duong Dinh Trung","url":"https://ddtrungit.github.io/authors/dtrungit/"},"publisher":{"@type":"Organization","name":"Duong Dinh Trung","logo":{"@type":"ImageObject","url":"https://ddtrungit.github.io/media/website/Background_2.png","height":800,"width":834}}}</script></head><body><header class="header" id="js-header"><a href="https://ddtrungit.github.io/index.html" class="logo"><img src="https://ddtrungit.github.io/media/website/Background_2.png" alt="TRUNG DUONG"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://ddtrungit.github.io/index.html" target="_self">Home</a></li><li><a href="https://ddtrungit.github.io/gioi-thieu/index.html" target="_self">About</a></li><li><a href="https://ddtrungit.github.io/tags/ansible/index.html" target="_self">Ansible</a></li><li><a href="https://ddtrungit.github.io/tags/aws/index.html" target="_self">AWS</a></li><li><a href="https://ddtrungit.github.io/tags/oracle/index.html" target="_self">Oracle</a></li><li><a href="https://ddtrungit.github.io/tags/linux/index.html" target="_self">Linux</a></li><li><a href="https://ddtrungit.github.io/tags/zimbra/index.html" target="_self">Zimbra</a></li><li><a href="https://ddtrungit.github.io/tags/tip/index.html" target="_self">TIP</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://ddtrungit.github.io/tags/ansible/index.html" class="post__maintag">Ansible</a><h1 class="post__title">Sử dụng Ansible thông qua Bastion Host</h1><div class="post__meta"><div class="post__author">By <a href="https://ddtrungit.github.io/authors/dtrungit/index.html" class="invert" rel="author" title="Duong Dinh Trung">Duong Dinh Trung</a></div></div></header><figure class="post__featured-image"><img src="https://ddtrungit.github.io/media/posts/110/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1.png" srcset="https://ddtrungit.github.io/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-xs.png 300w, https://ddtrungit.github.io/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-sm.png 480w, https://ddtrungit.github.io/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-md.png 768w, https://ddtrungit.github.io/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="368" width="1024" alt=""></figure><div class="post__inner"><div class="post__entry"><ul><li>Bastion host là gì?</li></ul><p style="text-align: left;">Bastion dịch theo nghĩa đen là một nơi được tăng cường. Về thuật ngữ máy tính, đó là một máy trên mạng có thể là gatekeeper cho các kết nối đến và đi. Wikipedia định nghĩa: Máy chủ pháo đài (bastion host) là một máy tính có mục đích đặc biệt trên mạng, được thiết kế và cấu hình riêng để chịu được các cuộc tấn công. Máy chủ pháo đài thường chỉ lưu trữ một ứng dụng duy nhất, ví dụ như máy chủ proxy, các dịch vụ khác sẽ bị xóa hoặc giới hạn để giảm thiểu mối đe dọa cho máy tính. Sở dĩ, bastion host được thiết lập cứng như vậy là do vị trí và mục đích đặc biệt của nó, thường được đặt bên ngoài tường lửa hoặc trong vùng DMZ (một vùng mạng trung lập giữa mạng nội bộ và mạng Internet) và thường liên quan đến những truy cập từ các mạng hoặc máy tính không đáng tin cậy. Bạn có thể thiết lập bastion host làm máy duy nhất chấp nhận kết nối từ Internet. Sau đó, lần lượt, thiết lập tất cả các máy khác trong mạng để chỉ nhận các kết nối đến từ máy bastion host này.</p><figure class="alignnone wp-image-504"><img loading="lazy" src="https://ddtrungit.github.io/media/posts/110/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-300x108.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://ddtrungit.github.io/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-300x108-xs.png 300w, https://ddtrungit.github.io/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-300x108-sm.png 480w, https://ddtrungit.github.io/media/posts/110/responsive/Screenshot-2021-05-22-at-9.24.14-PM-1024x368-1-300x108-md.png 768w" alt="" width="719" height="259"></figure><p>Khai báo các máy chủ vào :</p><blockquote><em>/etc/ansible/hosts</em></blockquote><p style="padding-left: 160px;"><em>[proxy]</em> <em>3.115.75.133</em></p><p style="padding-left: 160px;"><em>[web]</em> <em>10.1.0.48</em> <em>10.1.0.29</em></p><blockquote><em>/etc/ansible/ansible.cfg</em></blockquote><p style="padding-left: 40px;">[ssh_connection]</p><p style="padding-left: 40px;"><em>ssh_args = -F ~/.ssh/config -o ControlMaster=auto -o ControlPersist=30m -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -o ForwardAgent=yes</em> <em>control_path = ~/.ansible/cp/ansible-%%r@%%h:%%p</em></p><blockquote><em>/home/<strong>username</strong>/.ssh/config</em></blockquote><p style="padding-left: 160px;"><em>Host proxy</em> <em>Hostname 3.115.75.133</em> <em>IdentityFile ~/bastion_ssh_key</em> <em>User ec2-user</em></p><p style="padding-left: 160px;"><em>Host 3.115.75.130</em> <em>Hostname 3.115.75.133</em> <em>IdentityFile ~/bastion_ssh_key</em> <em>User ec2-user</em></p><p style="padding-left: 160px;"><em>Host api</em> <em>Hostname 10.1.0.48</em> <em>User ec2-user</em> <em>IdentityFile ~/web_ssh_key</em> <em>ProxyCommand ssh -W %h:%p proxy</em></p><p style="padding-left: 160px;"><em>Host admin</em> <em>Hostname 10.1.0.29</em> <em>User ec2-user</em> <em>IdentityFile ~/web_ssh_key</em> <em>ProxyCommand ssh -W %h:%p proxy</em> <em>Host 10.1.*</em> <em>User ec2-user</em> <em>IdentityFile ~/api_ssh_key</em> <em>ProxyCommand ssh -W %h:%p proxy</em></p><p>Như vậy khi chỉ định ansible group proxy hay web thì sẽ kết nối  ssh bình thường.</p></div><footer><div class="post__tags-share"><aside class="post__share"></aside></div></footer></div></article></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><a href="https://ddtrungit.github.io/ansible-la-gi-huong-dan-cai-dat-ansible/index.html" class="c-card__image"><img src="https://ddtrungit.github.io/media/posts/109/Ansible-la-gi-1.png" srcset="https://ddtrungit.github.io/media/posts/109/responsive/Ansible-la-gi-1-xs.png 300w, https://ddtrungit.github.io/media/posts/109/responsive/Ansible-la-gi-1-sm.png 480w, https://ddtrungit.github.io/media/posts/109/responsive/Ansible-la-gi-1-md.png 768w, https://ddtrungit.github.io/media/posts/109/responsive/Ansible-la-gi-1-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="358" width="750" alt=""></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://ddtrungit.github.io/tags/ansible/index.html">Ansible</a></div><h3 class="c-card__title"><a href="https://ddtrungit.github.io/ansible-la-gi-huong-dan-cai-dat-ansible/index.html" class="invert">Ansible Là Gì? Hướng Dẫn Cài Đặt Ansible</a></h3></header></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="https://facebook.com/duongtrung2103" aria-label="Facebook" class="facebook"><svg><use xlink:href="https://ddtrungit.github.io/assets/svg/svg-map.svg#facebook"/></svg></a></div><div class="footer__copyright">"DO THE THINGS YOU LOVE!"</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://ddtrungit.github.io/assets/js/scripts.min.js?v=d78591855e0ce96bf51239b499260e20"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>